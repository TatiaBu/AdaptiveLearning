function instructions(taskParam, whichPractice, subject)
%INSTRUCTIONS runs instructions for the cannon task.

% shift this
cannon = true;

% text settings
Screen('TextFont', taskParam.gParam.window.onScreen, 'Arial');
Screen('TextSize', taskParam.gParam.window.onScreen, 50);
sentenceLength = taskParam.gParam.sentenceLength;
if subject.rew == 1
    colRew = 'gold';
    colNoRew = 'grau';
elseif subject.rew == 2
    colRew = 'silber';
    colNoRew = 'gelb';
end

%% ------------------------------------------------------------------------
% Run instructions
% -------------------------------------------------------------------------

% first slide indicating task version
DisplayPartOfTask

% depending on task version, run specific instructions
if isequal(taskParam.gParam.taskType, 'dresden')
    if isequal(whichPractice, 'oddballPractice')...
            || (isequal(whichPractice, 'mainPractice')...
            && subject.cBal == 1)...
            || (isequal(whichPractice, 'mainPractice')...
            && subject.cBal == 2)...
            || (isequal(whichPractice, 'mainPractice')...
            && subject.cBal == 3)...
            || (isequal(whichPractice, 'followCannonPractice')...
            && subject.cBal == 4)...
            || (isequal(whichPractice, 'followCannonPractice')...
            && subject.cBal == 5)...
            || (isequal(whichPractice, 'followCannonPractice')...
            && subject.cBal == 6)
        
        SharedInstructions_MainOddballFollowCannon
        
    elseif isequal(whichPractice, 'oddballPractice')...
            || (isequal(whichPractice, 'mainPractice')...
            && subject.cBal == 4)...
            || (isequal(whichPractice, 'mainPractice')...
            && subject.cBal == 5)...
            || (isequal(whichPractice, 'mainPractice')...
            && subject.cBal == 6)
        
        MainJustInstructions
        
    elseif isequal(whichPractice, 'oddballPractice')...
            || (isequal(whichPractice, 'followCannonPractice')...
            && subject.cBal == 1)...
            || (isequal(whichPractice, 'followCannonPractice')...
            && subject.cBal == 2)...
            || (isequal(whichPractice, 'followCannonPractice')...
            && subject.cBal == 3)
        
        FollowCannonJustInstructions
        
    elseif isequal(whichPractice, 'followOutcomePractice')
        
        FollowOutcomeInstructions
        
    end
    
elseif isequal(taskParam.gParam.taskType, 'oddball')
    
    if (isequal(whichPractice, 'oddballPractice')...
            && subject.cBal == 1)...
            || (isequal(whichPractice, 'mainPractice')...
            && subject.cBal == 2)
        
        SharedInstructions_MainOddballFollowCannon
        
    elseif (isequal(whichPractice, 'oddballPractice')...
            && subject.cBal == 2)
        
        DisplayPartOfTask
        oddballPractice
        
    elseif (isequal(whichPractice, 'mainPractice') &&...
            subject.cBal == 1)
        
        MainAndFollowCannon_CannonVisibleNoNoise
        MainAndFollowCannon_CannonVisibleNoise
        
    end
    
elseif isequal(taskParam.gParam.taskType, 'reversal') ||...
        isequal(taskParam.gParam.taskType, 'chinese') ||...
        isequal(taskParam.gParam.taskType, 'ARC')

    
    SharedInstructions_MainOddballFollowCannon
    
end

%% ------------------------------------------------------------------------
% Functions that implement instructions
% -------------------------------------------------------------------------

    function DisplayPartOfTask
        %DISPLAYPARTOFTASK   Prints task version at the beginning of the
        %task
        
        Screen('TextFont', taskParam.gParam.window.onScreen, 'Arial');
        Screen('TextSize', taskParam.gParam.window.onScreen, 30);
        
        if isequal(taskParam.gParam.taskType, 'dresden')
            
            if (isequal(whichPractice, 'mainPractice')...
                    && subject.cBal == 1)...
                    || (isequal(whichPractice, 'mainPractice')...
                    && subject.cBal == 2)...
                    || (isequal(whichPractice, 'followOutcomePractice')...
                    && subject.cBal == 3)...
                    || (isequal(whichPractice, 'followOutcomePractice')...
                    && subject.cBal == 5)...
                    || (isequal(whichPractice, 'followCannonPractice')...
                    && subject.cBal == 4)...
                    || (isequal(whichPractice, 'followCannonPractice')...
                    && subject.cBal == 6)
                
                txt='Herzlich Willkommen\n\nErste Aufgabe...';
                
            elseif (isequal(whichPractice, 'mainPractice')...
                    && subject.cBal == 3)...
                    || (isequal(whichPractice, 'mainPractice') &&...
                    subject.cBal == 4)...
                    || (isequal(whichPractice, 'followOutcomePractice')...
                    && subject.cBal == 1)...
                    || (isequal(whichPractice, 'followOutcomePractice')...
                    && subject.cBal == 6)...
                    || (isequal(whichPractice, 'followCannonPractice')...
                    && subject.cBal == 2)...
                    || (isequal(whichPractice, 'followCannonPractice')...
                    && subject.cBal == 5)
                
                txt = 'Zweite Aufgabe...';
                
            elseif (isequal(whichPractice, 'mainPractice')...
                    && subject.cBal == 5)...
                    || (isequal(whichPractice, 'mainPractice')...
                    && subject.cBal == 6)...
                    || (isequal(whichPractice, 'followOutcomePractice')...
                    && subject.cBal == 2)...
                    || (isequal(whichPractice, 'followOutcomePractice')...
                    && subject.cBal == 4)...
                    || (isequal(whichPractice, 'followCannonPractice')...
                    && subject.cBal == 1)...
                    || (isequal(whichPractice, 'followCannonPractice')...
                    && subject.cBal == 3)
                
                txt = 'Dritte Aufgabe...';
                
            end
            
        else
            
            if isequal(whichPractice, 'oddballPractice')
                txt = 'Oddball Task';
            elseif isequal(whichPractice, 'mainPractice')
                txt = 'Change Point Task';
            elseif isequal(whichPractice, 'reversal')
                txt = 'Reversal Task';
            elseif isequal(whichPractice, 'chinese')
                txt = 'Beschütze Deine Planeten';
            end
            
        end
        
        while 1
            screenIndex = 1;
            
            
            
              if ~isequal(whichPractice, 'chinese')
                    Screen('FillRect', taskParam.gParam.window.onScreen, []);
                    DrawFormattedText(taskParam.gParam.window.onScreen, txt,...
                        'center', 100, [0 0 0]);
                    Screen('DrawingFinished', taskParam.gParam.window.onScreen);
                    t = GetSecs;
                    Screen('Flip', taskParam.gParam.window.onScreen, t + 0.1);
                    %[~, ~, keyCode] = KbCheck;
              else
                  
                    YourTaskScreen(txt,...
                        taskParam.textures.spacebattleTxt, screenIndex);
                    
              end
                                [~, ~, keyCode] = KbCheck;

            if find(keyCode) == taskParam.keys.enter
                break
            end
        end
        
        WaitSecs(0.1);
    end

    function SharedInstructions_MainOddballFollowCannon
        %SHAREDINSTRUCTIONS_MAINODDBALLFOLLOWCANNON   Runs first
        %part of the instructions for change point, oddball, follow
        %cannon and reversal task
        
        screenIndex = 1;
        
        while 1
            
            switch(screenIndex)
                
                case 1
                    
                    if isequal(taskParam.gParam.taskType, 'dresden')
                        txt = 'Kanonenkugeln Abwehren';
                        
                        screenIndex = YourTaskScreen(txt,...
                            taskParam.textures.shieldTxt, screenIndex);
                    else
                        screenIndex = screenIndex + 1;
                    end
                    
                case 2
                    
                    screenIndex = FirstCannonSlide(screenIndex);
                    
                case 3
                    
                    [screenIndex, Data] =...
                        PressSpaceToInitiateCannonShot(screenIndex, true);
                    
                    WaitSecs(0.1);
                    
                case 4
                    distMean = 290;
                    if isequal(taskParam.gParam.taskType, 'dresden')
                        if isequal(subject.group, '1')
                            txt=['Der schwarze Strich zeigt dir die '...
                                'Position der letzten Kugel. Der '...
                                'orangene Strich zeigt dir die '...
                                'Position deines letzten Schildes. '...
                                'Steuere den orangenen Punkt jetzt auf '...
                                'das Ziel der Kanone und drücke '...
                                'LEERTASTE.'];
                        else
                            txt=['Der schwarze Strich zeigt Ihnen die '...
                                'Position der letzten Kugel. Der '...
                                'orangene Strich zeigt Ihnen die '...
                                'Position Ihres letzten Schildes. '...
                                'Steuern Sie den orangenen Punkt jetzt '...
                                'bitte auf das Ziel der Kanone und '...
                                'drücken Sie LEERTASTE.'];
                        end
                    elseif isequal(taskParam.gParam.taskType, 'oddball')
                        txt=['Move the orange spot to the part of the '...
                            'circle, where the cannon is aimed and '...
                            'press SPACE.'];
                    elseif isequal(taskParam.gParam.taskType, 'reversal') ||...
                            isequal(taskParam.gParam.taskType, 'ARC')
                        txt=['Move the orange spot to the part of the '...
                            'circle, where the cannon is aimed and '...
                            'press the left mouse button.'];
                    elseif isequal(taskParam.gParam.taskType, 'chinese')
                        txt=['Bewege den orangenen Punkt zu der Stelle '...
                            'auf dem Planeten auf die die Kanone zielt '...
                            'und drücke die linke Maustaste.'];
                    end
                    [screenIndex, Data] = MoveSpotToCannonAim...
                        (screenIndex, txt, distMean, Data);
                    
                case 5
                    
                    distMean = 290;
                    screenIndex = YouMissedTheCannonBall_TryAgain...
                        (screenIndex, Data, distMean);
                    
                case 6
                    
                    if isequal(taskParam.gParam.taskType, 'dresden')
                        if isequal(subject.group, '1')
                            txt=['Das Schild erscheint nach dem '...
                                'Schuss. In diesem Fall hast du die '...
                                'Kanonenkugel abgewehrt. '...
                                'Wenn mindestens die Hälfte der Kugel '...
                                'auf dem Schild ist, zählt es als '...
                                'Treffer.'];
                        else
                            txt=['Das Schild erscheint nach dem '...
                                'Schuss. In diesem Fall haben Sie die '...
                                'Kanonenkugel abgewehrt. '...
                                'Wenn mindestens die Hälfte der Kugel '...
                                'auf dem Schild ist, zählt es als '...
                                'Treffer.'];
                        end
                    elseif isequal(taskParam.gParam.taskType, 'oddball')...
                            || isequal(taskParam.gParam.taskType,'reversal')...
                            || isequal(taskParam.gParam.taskType,'ARC')
                        txt=['After the cannon is shot you will see '...
                            'the shield. In this case you caught the '...
                            'ball. If at least half of the ball '...
                            'overlaps with the shield then it is '...
                            'a "catch".'];
                    elseif isequal(taskParam.gParam.taskType, 'chinese')
                        txt=['Dein Schild erscheint nach dem Schuss '...
                            'des Raumschiffs. In diesem Fall hast du '...
                            'die Kanonenkugel abgewehrt. Wenn mindestens '...
                            'die Hälfte der Kugel auf dem Schild ist, '...
                            'hast du sie erfolgreich abgewehrt.'];
                    end
                    win = true;
                    [screenIndex, Data] =...
                        AfterCannonIsShotYouSeeTheShield...
                        (screenIndex, Data, txt, distMean, win);
                    
                case 7
                    
                    if isequal(taskParam.gParam.taskType, 'dresden')
                        if isequal(subject.group, '1')
                            txt = ['Steuere den orangenen Punkt '...
                                'jetzt neben das Ziel der Kanone, so '...
                                'dass du die Kanonenkugel verfehlst '...
                                'und drücke LEERTASTE.'];
                        else
                            txt = ['Steuern Sie den orangenen Punkt '...
                                'jetzt bitte neben das Ziel der '...
                                'Kanone, so dass Sie die Kanonenkugel '...
                                'verfehlen und drücken Sie LEERTASTE.'];
                        end
                        
                    elseif isequal(taskParam.gParam.taskType, 'oddball')
                        txt = ['Now try to place the shield so that '...
                            'you miss the cannonball. Then hit SPACE. '];
                    elseif isequal(taskParam.gParam.taskType, 'reversal')...
                             || isequal(taskParam.gParam.taskType, 'ARC')
                        txt = ['Now try to place the shield so '...
                            'that you miss the cannonball. Then hit '...
                            'the left mouse button. '];
                    elseif isequal(taskParam.gParam.taskType, 'chinese')
                        txt = ['Versuche nun dein Schild so zu '...
                            'positionieren, dass du die Kanonenkugel '...
                            'verfehlst. Drücke dann die linke Maustaste.'];
                    end
                    distMean = 65;
                    [screenIndex, Data] = TryToMissTheCannon...
                        (screenIndex, Data, txt, distMean);
                    
                case 8
                    
                    Data.outcome = distMean;
                    [screenIndex, Data, t] =...
                        YouCaughtTheCannonball_TryToMissIt...
                        (screenIndex, Data, distMean);
                    
                case 9
                    
                    if isequal(taskParam.gParam.taskType, 'dresden')
                        if isequal(subject.group, '1')
                            txt=['In diesem Fall hast du die '...
                                'Kanonenkugel verpasst.'];
                        else
                            txt=['In diesem Fall haben Sie die '...
                                'Kanonenkugel verpasst.'];
                            
                        end
                    elseif isequal(taskParam.gParam.taskType, 'oddball')...
                            ||isequal(taskParam.gParam.taskType,'reversal')...
                            ||isequal(taskParam.gParam.taskType,'ARC') 
                        txt='In this case you missed the cannonball.';
                    elseif isequal(taskParam.gParam.taskType, 'chinese')
                        txt='In diesem Fall hast du die Kanonenkugel verfehlt.';
                    end
                    win = true;
                    [screenIndex, Data, t] =...
                        InThisCaseYouMissedTheCannonball...
                        (screenIndex, Data, t, txt, distMean, win);
                    
                case 10
                    if isequal(taskParam.gParam.taskType, 'dresden')
                        if isequal(subject.group, '1')
                            txt = sprintf(['Wenn du Kanonenkugeln '...
                                'abwehrst, kannst du Geld verdienen. '...
                                'Wenn das Schild %s ist, verdienst '...
                                'du %s CENT wenn du die Kanonenkugel '...
                                'abwehrst. Wenn das Schild %s ist, '...
                                'verdienst du nichts. Ebenso wie die '...
                                'Farbe, kann auch die Größe deines '...
                                'Schildes variieren. Die Farbe und '...
                                'die Größe des Schildes siehst '...
                                'du erst, nachdem die Kanone '...
                                'geschossen hat. Daher versuchst du am '...
                                'besten jede Kanonenkugel abzuwehren.'...
                                '\n\nUm einen Eindruck von der '...
                                'wechselnden Größe und Farbe des '...
                                'Schildes zu bekommen, kommt jetzt '...
                                'eine kurze Übung.\n\n'], colRew,...
                                num2str(100*taskParam.gParam.rewMag),...
                                colNoRew);
                        else
                            txt = sprintf(['Wenn Sie Kanonenkugeln '...
                                'abwehren, können Sie Geld verdienen. '...
                                'Wenn das Schild %s ist, verdienen '...
                                'Sie %s CENT wenn Sie die Kanonenkugel '...
                                'abwehren. Wenn das Schild %s ist, '...
                                'verdienen Sie nichts. Ebenso wie die '...
                                'Farbe, kann auch die Größe Ihres '...
                                'Schildes variieren.Die Farbe und die '...
                                'Größe des Schildes sehen Sie erst, '...
                                'nachdem die Kanone geschossen hat. '...
                                'Daher versuchen Sie am besten jede '...
                                'Kanonenkugel abzuwehren.\n\n'...
                                'Um einen Eindruck von der wechselnden '...
                                'Größe und Farbe des Schildes zu '...
                                'bekommen, kommt jetzt eine kurze '...
                                'Übung.\n\n'], colRew, num2str...
                                (100*taskParam.gParam.rewMag), colNoRew);
                        end
                    end
                    [screenIndex, Data] = YourShield...
                        (screenIndex, Data, txt);
                    
                case 11
                    

                    [screenIndex, Data] = ShieldPractice...
                        (screenIndex, whichPractice);
                    
                    if isequal(taskParam.gParam.taskType, 'chinese') ||...
                            isequal(taskParam.gParam.taskType, 'ARC')
                        screenIndex = 25;
                    end
                    
                    
                case 12
                    
                    screenIndex = TrialOutcomes(screenIndex);
                    
                case 13
                    
                    distMean = 290;
                    if isequal(taskParam.gParam.taskType, 'dresden')
                        if isequal(subject.group, '1')
                            txt = ['Versuche die Kanonenkugel jetzt '...
                                'wieder zu abzuwehren.'];
                        else
                            txt = ['Versuchen Sie die Kanonenkugel '...
                                'jetzt wieder zu abzuwehren.'];
                        end
                    elseif isequal(taskParam.gParam.taskType, 'oddball')...
                            || isequal(taskParam.gParam.taskType,...
                            'reversal')
                        txt='Now try to catch the ball.';
                    end
                    
                    [screenIndex, Data] = MoveSpotToCannonAim...
                        (screenIndex, txt, distMean, Data);
                    
                case 14
                    
                    [screenIndex, Data] =...
                        YouMissedTheCannonBall_TryAgain...
                        (screenIndex, Data, distMean);
                    
                case 15
                    
                    if isequal(taskParam.gParam.taskType, 'dresden')
                        if isequal(subject.group, '1')
                            if isequal(whichPractice, 'followOutcome')
                                txt = sprintf(['Weil du die '...
                                    'Kanonenkugel abgewehrt '...
                                    'hast und der Korb %s war, '...
                                    'hättest du jetzt %s CENT '...
                                    'verdient.'], colRew,...
                                    num2str(100*taskParam.gParam.rewMag));
                            else
                                txt = sprintf(['Weil du die '...
                                    'Kanonenkugel abgewehrt '...
                                    'hast und das Schild %s war, '...
                                    'hättest du jetzt %s CENT '...
                                    'verdient.'], colRew,...
                                    num2str(100*taskParam.gParam.rewMag));
                            end
                        else
                            if isequal(whichPractice, 'followOutcome')
                                txt = sprintf(['Weil Sie die '...
                                    'Kanonenkugel abgewehrt '...
                                    'haben und der Korb %s war, '...
                                    'hätten Sie jetzt %s CENT '...
                                    'verdient.'], colRew,...
                                    num2str(100*taskParam.gParam.rewMag));
                            else
                                txt = sprintf(['Weil Sie die '...
                                    'Kanonenkugel abgewehrt '...
                                    'haben und das Schild %s war, '...
                                    'hätten Sie jetzt %s CENT '...
                                    'verdient.'], colRew,...
                                    num2str(100*taskParam.gParam.rewMag));
                            end
                        end
                    elseif isequal(taskParam.gParam.taskType, 'oddball')...
                            ||isequal(taskParam.gParam.taskType,'reversal')
                        txt = sprintf(['You caught the ball and the '...
                            'shield is %s. So you would earn %s CENTS.'],...
                            colRew, num2str(100*taskParam.gParam.rewMag));
                    end
                    
                    win = true;
                    [screenIndex, Data] =...
                        AfterCannonIsShotYouSeeTheShield...
                        (screenIndex, Data, txt, distMean, win);
                    
                case 16
                    
                    if isequal(taskParam.gParam.taskType, 'dresden')
                        if isequal(subject.group, '1')
                            txt = ['Versuche die Kanonenkugel beim '...
                                'nächsten Schuss zu verfehlen.'];
                        else
                            txt=['Versuchen Sie die Kanonenkugel '...
                                'bitte beim nächsten Schuss '...
                                'zu verfehlen.'];
                        end
                    elseif isequal(taskParam.gParam.taskType, 'oddball')...
                            ||isequal(taskParam.gParam.taskType,'reversal')
                        txt = 'Now try to miss the ball.';
                    end
                    distMean = 35;
                    [screenIndex, Data] = TryToMissTheCannon...
                        (screenIndex, Data, txt, distMean);
                    
                case 17
                    
                    Data.outcome = distMean;
                    [screenIndex, Data, t] =...
                        YouCaughtTheCannonball_TryToMissIt...
                        (screenIndex, Data, distMean);
                    
                case 18
                    
                    if isequal(taskParam.gParam.taskType, 'dresden')
                        if isequal(subject.group, '1')
                            txt=['Weil du die Kanonenkugel verpasst '...
                                'hast, hättest du nichts verdient.'];
                        else
                            txt=['Weil Sie die Kanonenkugel verpasst '...
                                'haben, hätten Sie nichts verdient.'];
                        end
                    elseif isequal(taskParam.gParam.taskType, 'oddball')...
                            ||isequal(taskParam.gParam.taskType,'reversal')
                        txt = ['You missed the ball so you would earn '...
                            'nothing.'];
                    end
                    win = true;
                    
                    [screenIndex, Data, t] =...
                        InThisCaseYouMissedTheCannonball...
                        (screenIndex, Data, t, txt, distMean, win);
                    
                case 19
                    
                    distMean = 190;
                    
                    if isequal(taskParam.gParam.taskType, 'dresden')
                        if isequal(subject.group, '1')
                            
                            txt = ['Versuche die Kanonenkugel jetzt '...
                                'wieder zu abzuwehren.'];
                        else
                            txt = ['Versuchen Sie bitte die '...
                                'Kanonenkugel wieder zu abzuwehren.'];
                            
                        end
                    elseif isequal(taskParam.gParam.taskType, 'oddball')...
                            ||isequal(taskParam.gParam.taskType,'reversal')
                        txt='Now try to catch the ball.';
                    end
                    
                    [screenIndex, Data] =...
                        MoveSpotToCannonAim...
                        (screenIndex, txt, distMean, Data);
                    
                case 20
                    
                    screenIndex =...
                        YouMissedTheCannonBall_TryAgain...
                        (screenIndex, Data, distMean);
                    
                case 21
                    
                    if isequal(taskParam.gParam.taskType, 'dresden')
                        if isequal(subject.group, '1')
                            
                            
                            txt=sprintf(['Du hast die Kanonenkugel '...
                                'abgewehrt, aber das Schild war %s. '...
                                'Daher hättest du nichts verdient.'],...
                                colNoRew);
                            
                        else
                            
                            txt=sprintf(['Sie haben die Kanonenkugel '...
                                'abgewehrt, aber das Schild war %s. '...
                                'Daher hätten Sie nichts verdient.'],...
                                colNoRew);
                            
                        end
                    elseif isequal(taskParam.gParam.taskType, 'oddball')...
                            ||isequal(taskParam.gParam.taskType,'reversal')
                        txt=sprintf(['You caught the ball and your '...
                            'shield was %s so you would earn nothing.'],...
                            colNoRew);
                    end
                    
                    
                    win = false;
                    [screenIndex, Data] =...
                        AfterCannonIsShotYouSeeTheShield...
                        (screenIndex, Data, txt, distMean, win);
                    
                case 22
                    Data.outcome = distMean;
                    distMean = 160;
                    
                    if isequal(taskParam.gParam.taskType, 'dresden')
                        if isequal(subject.group, '1')
                            
                            txt=['Versuche die Kanonenkugel bei '...
                                'nächsten Schuss zu verfehlen.'];
                        else
                            txt=['Versuchen Sie bitte die Kanonenkugel '...
                                'bei nächsten Schuss zu verfehlen.'];
                        end
                    elseif isequal(taskParam.gParam.taskType, 'oddball')...
                            ||isequal(taskParam.gParam.taskType,'reversal')
                        txt = 'Now try to miss the ball.';
                    end
                    [screenIndex, Data] =...
                        TryToMissTheCannon...
                        (screenIndex, Data, txt, distMean);
                    
                case 23
                    
                    distMean = 160;
                    Data.outcome = distMean;
                    [screenIndex, Data, t] =...
                        YouCaughtTheCannonball_TryToMissIt...
                        (screenIndex, Data, distMean);
                    
                case 24
                    
                    if isequal(taskParam.gParam.taskType, 'dresden')
                        if isequal(subject.group, '1')
                            
                            txt=['Weil du die Kanonenkugel verpasst '...
                                'hast, hättest du nichts verdient.'];
                        else
                            txt=['Weil Sie die Kanonenkugel verpasst '...
                                'haben, hätten Sie nichts verdient.'];
                        end
                    elseif isequal(taskParam.gParam.taskType, 'oddball')...
                            ||isequal(taskParam.gParam.taskType,'reversal')
                        txt = ['You missed the ball so you would earn '...
                            'nothing.'];
                    end
                    win = false;
                    [screenIndex, Data, t] =...
                        InThisCaseYouMissedTheCannonball...
                        (screenIndex, Data, t, txt, distMean, false);
                    
                case 25
                    
                    if isequal(whichPractice, 'mainPractice')...
                            || (isequal(whichPractice,...
                            'followCannonPractice')...
                            && subject.cBal == 4)...
                            || (isequal(whichPractice,...
                            'followCannonPractice')...
                            && subject.cBal == 5)...
                            || (isequal(whichPractice,...
                            'followCannonPractice')...
                            && subject.cBal == 6)
                        
                        MainAndFollowCannon_CannonVisibleNoNoise
                        
                        MainAndFollowCannon_CannonVisibleNoise
                        
                    elseif isequal(whichPractice, 'oddballPractice')
                        
                        oddballPractice
                        
                        
                    elseif isequal(taskParam.gParam.taskType, 'reversal')
                        
                        reversalPractice
                        
                    elseif isequal(taskParam.gParam.taskType, 'dresden')
                        
                        FollowCannonJustInstructions
                        
                    elseif (isequal(whichPractice, 'chinese'))
                        
                        chinesePractice
                        
                    end
                    
                    break
            end
        end
    end

    function MainAndFollowCannon_CannonVisibleNoNoise
        
        screenIndex = 1;
        
        while 1
            
            switch(screenIndex)
                
                case 1
                    
                    if isequal(taskParam.gParam.taskType, 'dresden')
                        header = 'Erste Übung';
                    else
                        header = 'First Practice';
                    end
                    
                    if isequal(whichPractice, 'mainPractice')...
                            || isequal(whichPractice,...
                            'followCannonPractice')
                        
                        if isequal(taskParam.gParam.taskType, 'dresden')
                            
                            if isequal(subject.group, '1')
                                
                                
                                txt=['In dieser Übung ist das Ziel '...
                                    'möglichst viele Kanonenkugeln '...
                                    'abzuwehren. Die Kanone bleibt '...
                                    'meistens an der selben Stelle. '...
                                    'Manchmal dreht sich die Kanone '...
                                    'allerdings und zielt auf eine '...
                                    'andere Stelle. Wenn du den '...
                                    'orangenen Punkt genau auf die '...
                                    'Stelle steuerst, auf die die '...
                                    'Kanone zielt, wehrst du die '...
                                    'meisten Kugeln ab.\n\nWenn du '...
                                    'deinen Punkt zu oft neben die '...
                                    'anvisierte Stelle steuerst, wird '...
                                    'die Übung wiederholt.'];
                                
                            else
                                txt=['In dieser Übung ist das Ziel '...
                                    'möglichst viele Kanonenkugeln '...
                                    'abzuwehren. Die Kanone bleibt '...
                                    'meistens an der selben Stelle. '...
                                    'Manchmal dreht sich die Kanone '...
                                    'allerdings und zielt auf eine '...
                                    'andere Stelle. Wenn Sie den '...
                                    'orangenen Punkt genau auf die '...
                                    'Stelle steuern, auf die die '...
                                    'Kanone zielt, wehren Sie die '...
                                    'meisten Kugeln ab.\n\nWenn Sie '...
                                    'Ihren Punkt zu oft neben die '...
                                    'anvisierte Stelle steuern, '...
                                    'wird die Übung wiederholt.'];
                                
                                
                                %end
                            end
                        else
                            txt = ['You will will now need to catch '...
                                'cannonballs shot from a cannon.'...
                                'The cannon will usually remain aimed '...
                                'at the same location. However, '...
                                'occasionally the cannon will be '...
                                'reaimed to a completely different '...'
                                'part of the circle.\n\nTo earn most '...
                                'money you should center your shield '...
                                'on the location at which the cannon '...
                                'is aimed.'];
                            
                        end
                        
                    else
                        
                        if isequal(subject.group, '1')
                            txt=['In dieser Übung ist das Ziel '...
                                'möglichst viele Kanonenkugeln '...
                                'aufzusammeln. Du wirst feststellen, '...
                                'dass die Kanone relativ ungenau '...
                                'schießt, aber meistens auf die selbe '...
                                'Stelle zielt. Manchmal dreht sich die '...
                                'Kanone allerdings auch und zielt auf '...
                                'eine andere Stelle. Du verdienst am '...
                                'meisten, wenn du den orangenen Punkt '...
                                'genau auf den schwarzen Strich '...
                                'steuerst, weil du so sicher die Kugel '...
                                'aufsammelst. \n\nWenn du die Kugel zu '...
                                'oft nicht aufsammelst, wird die '...
                                'Übung wiederholt.'];
                        else
                            txt=['In dieser Übung ist das Ziel '...
                                'möglichst viele Kanonenkugeln '...
                                'aufzusammeln. Sie werden feststellen, '...
                                'dass die Kanone relativ ungenau '...
                                'schießt, aber meistens auf die selbe '...
                                'Stelle zielt. Manchmal dreht sich die '...
                                'Kanone allerdings auch und zielt auf '...
                                'eine andere Stelle. Sie verdienen am '...
                                'meisten, wenn Sie den orangenen Punkt '...
                                'genau auf den schwarzen Strich '...
                                'steuern, weil Sie so sicher die Kugel '...
                                'aufsammeln. \n\nWenn Sie die Kugel zu '...
                                'oft nicht aufsammeln, wird die '...
                                'Übung wiederholt.'];
                        end
                        
                    end
                    feedback = false;
                    fw = bigScreen(taskParam, ...
                        taskParam.strings.txtPressEnter, header,...
                        txt, feedback);
                    
                    if fw == 1
                        screenIndex = screenIndex + 1;
                    end
                    WaitSecs(0.1);
                    
                case 2
                    
                    condition = 'mainPractice_1';
                    LoadData = 'CP_NoNoise';
%                     [taskParam, practData] = practLoop(taskParam,...
%                         subject, taskParam.gParam.haz(1),...
%                         taskParam.gParam.concentration(3),...
%                         cannon, condition, LoadData);
                    
                    % added this (02.01.17) to get rid of practLoop
                    [taskData, Data] =  main(taskParam,...
                        taskParam.gParam.haz(1),...
                        taskParam.gParam.concentration(3),...
                            condition, subject);
                   
%                     [txt, header] = AL_feedback(taskData, taskParam,...
%                         subject, condition);
%                     feedback = true;
%                     warning('vorher')
%                     bigScreen(taskParam,...
%                         taskParam.strings.txtPressEnter,...
%                         header, txt, feedback);
%                     warning('nachher')
                         screenIndex = screenIndex + 1;
               
                    WaitSecs(0.1);
                    
                case 3
                    
                    screenIndex = performanceCriterion...
                        (screenIndex, taskData);
                    
                case 4
                    
                    break
                    
            end
            
        end
        
    end

    function MainAndFollowCannon_CannonVisibleNoise
        
        screenIndex = 1;
        
        while 1
            
            switch(screenIndex)

                case 1
                      
                    
                    %if isequal(taskParam.gParam.taskType, 'ARC')
                     %   warning('hier nur für ARC spezifiziert! noch für reversal und so anpassen')
                    if isequal(whichPractice, 'mainPractice')...
                            || isequal(whichPractice,...
                            'followCannonPractice')
                        if isequal(taskParam.gParam.taskType, 'dresden')
                            header = 'Zweite Übung';
                        else
                            header = 'Second Practice';
                        end
                        
                        if isequal(taskParam.gParam.taskType, 'dresden')
                            
                            if isequal(subject.group, '1')
                                
                                txt=['Weil die Kanone schon sehr alt '...
                                    'ist, sind die Schüsse ziemlich '...
                                    'ungenau. Das heißt, auch wenn '...
                                    'du genau auf das Ziel gehst, '...
                                    'kannst du die Kugel verfehlen. '...
                                    'Die Ungenauigkeit ist zufällig, '...
                                    'dennoch wehrst du die meisten '...
                                    'Kugeln ab, wenn du den orangenen '...
                                    'Punkt genau auf die Stelle '...
                                    'steuerst, auf die die Kanone '...
                                    'zielt.\n\nIn der nächsten Übung '...
                                    'sollst du mit der Ungenauigkeit '...
                                    'der Kanone erstmal vertraut '...
                                    'werden. Lasse den orangenen Punkt '...
                                    'bitte immer auf der anvisierten '...
                                    'Stelle stehen. Wenn du deinen '...
                                    'Punkt zu oft '...
                                    'neben die anvisierte Stelle '...
                                    'steuerst, wird die Übung '...
                                    'wiederholt.'];
                                
                            else
                                
                                txt=['Weil die Kanone schon sehr alt '...
                                    'ist, sind die Schüsse ziemlich '...
                                    'ungenau. Das heißt, auch wenn '...
                                    'Sie genau auf das Ziel gehen, '...
                                    'können Sie die Kugel verfehlen. '...
                                    'Die Ungenauigkeit ist zufällig, '...
                                    'dennoch wehren Sie die meisten '...
                                    'Kugeln ab, wenn Sie den orangenen '...
                                    'Punkt genau auf die Stelle '...
                                    'steuern, auf die die Kanone '...
                                    'zielt.\n\nIn der nächsten Übung '...
                                    'sollen Sie mit der Ungenauigkeit '...
                                    'der Kanone erstmal vertraut werden. '...
                                    'Lassen Sie den orangenen Punkt '...
                                    'bitte immer auf der anvisierten '...
                                    'Stelle stehen. Wenn Sie Ihren '...
                                    'Punkt zu oft neben die anvisierte '...
                                    'Stelle steuern, wird die '...
                                    'Übung wiederholt.'];
                                
                            end
                        else
                            
                            txt = ['In this block you will encounter a '...
                                'cannon that is not perfectly '...
                                'accurate. On some trials it will '...
                                'shoot a bit above where it is aimed '...
                                'and on other trials a bit below. '...
                                'Your best strategy is still to place '...
                                'the shield in the location where the '...
                                'cannon is aimed.\n\nThe cannon will '...
                                'still remain stable on most trials '...
                                'but be reaimed to another location '...
                                'on the cirlce occasionally.'];
                        end
                        
                    else
                        
                        header = 'Erste Übung';
                        
                        
                        if isequal(subject.group, '1')
                            
                            
                            
                            
                            txt=['In dieser Übung ist das Ziel möglichst '...
                                'viele Kanonenkugeln aufzusammeln. '...
                                'Du wirst feststellen, dass die Kanone '...
                                'relativ ungenau schießt, aber meistens '...
                                'auf die selbe Stelle zielt. Diese '...
                                'Ungenauigkeit ist zufällig. Manchmal '...
                                'dreht sich die Kanone '...
                                'auch und zielt auf eine andere Stelle. '...
                                'Du verdienst am meisten, wenn du den '...
                                'orangenen Punkt genau auf den '...
                                'schwarzen Strich steuerst, weil du '...
                                'so sicher die Kugel aufsammelst. '...
                                '\n\nWenn du die Kugel zu oft nicht '...
                                'aufsammelst, wird die Übung wiederholt.'];
                        else
                            
                            txt=['In dieser Übung ist das Ziel möglichst '...
                                'viele Kanonenkugeln aufzusammeln. '...
                                'Du wirst feststellen, dass die Kanone '...
                                'relativ ungenau schießt, aber meistens '...
                                'auf die selbe Stelle zielt. Diese '...
                                'Ungenauigkeit ist zufällig. Manchmal '...
                                'dreht sich die Kanone '...
                                'auch und zielt auf eine andere Stelle. '...
                                'Du verdienst am meisten, wenn du den '...
                                'orangenen Punkt genau auf den '...
                                'schwarzen Strich steuerst, weil du '...
                                'so sicher die Kugel aufsammelst. '...
                                '\n\nWenn du die Kugel zu oft nicht '...
                                'aufsammelst, wird die Übung wiederholt.'];
                        end
                        
                        
                        %end
                        
                    end
                    
%                     feedback = false;
%                     fw = bigScreen(taskParam,...
%                         taskParam.strings.txtPressEnter,...
%                         header, txt, feedback);
                    %if fw == 1
                        screenIndex = screenIndex + 1;
                    %elseif bw == 1
                    %    screenIndex = screenIndex - 3;
                    %end
                    
                    
                    WaitSecs(0.1);
                case 2
                    
                    
                    LoadData = 'CP_Noise';
                    if isequal(whichPractice, 'mainPractice')
                        condition = 'mainPractice_2';
                    elseif isequal(whichPractice, 'followCannonPractice')
                        condition = 'followCannonPractice';
                    elseif isequal(whichPractice, 'followOutcomePractice')
                        condition = 'followOutcomePractice';
                    end
                    
                    
%                     [taskParam, practData] = practLoop(taskParam,...
%                         subject, taskParam.gParam.haz(1),...
%                         taskParam.gParam.concentration(1),...
%                         cannon, condition,LoadData);
                    % added this (02.01.17) to get rid of practLoop
                    [taskData, Data] =  main(taskParam,...
                        taskParam.gParam.haz(1),...
                        taskParam.gParam.concentration(3),...
                            condition, subject);
                    
                    
                    [txt, header] = AL_feedback(taskData,...
                        taskParam, subject, condition);
                    
                    feedback = true;
                    fw = bigScreen(taskParam,...
                        taskParam.strings.txtPressEnter,...
                        header, txt, feedback);
                    
                    if fw == 1
                        screenIndex = screenIndex + 1;
                    elseif bw == 1
                        screenIndex = screenIndex - 1;
                    end
                    WaitSecs(0.1);
                    
                case 3
                    
                    screenIndex = performanceCriterion(screenIndex,...
                        taskData);
                    
                case 4
                    
                    if isequal(whichPractice, 'followCannonPractice')
                        FollowCannonJustInstructions
                        
                    elseif isequal(whichPractice, 'followOutcomePractice')
                        break
                    else
                        MainJustInstructions
                    end
                    
                    break
            end
            
        end
        
    end

    function oddballPractice
        
        screenIndex = 1;
        
        while 1
            
            switch(screenIndex)
                
                
                case 1
                    
                    header = 'First Practice';
                    txt = ['In this block of trials you will try to '...
                        'catch balls shot from a cannon. The aim of '...
                        'the cannon will not be stationary but instead '...
                        'move unpredictably.'];
                    
                    feedback = false;
                    fw = bigScreen(taskParam, ...
                        taskParam.strings.txtPressEnter, header,...
                        txt, feedback);
                    if fw == 1
                        screenIndex = screenIndex + 1;
                    elseif bw == 1
                        screenIndex = screenIndex - 1;
                    end
                    WaitSecs(0.1);
                    
                case 2
                    
                    condition = 'practiceNoOddball';
                    %LoadData = 'NoNoise';
                    LoadData = 'None';
                    
%                     [taskParam, practData] = practLoop(taskParam,...
%                         subject, taskParam.gParam.haz(3),...
%                         taskParam.gParam.concentration(3),...
%                         cannon, condition, LoadData);
                    % added this (02.01.17) to get rid of practLoop
                    [taskParam, practData] =  main(taskParam,...
                        taskParam.gParam.haz(1),...
                        taskParam.gParam.concentration(3),...
                            condition, subject);
                    
                    [txt, header] = AL_feedback(practData, taskParam,...
                        subject, condition);
                    feedback = true;
                    fw = bigScreen(taskParam,...
                        taskParam.strings.txtPressEnter, header,...
                        txt,feedback);
                    sumCannonDev = sum(practData.cannonDev >= 10);
                    if fw == 1
                        if isequal(taskParam.gParam.taskType, 'oddball')...
                                && subject.cBal == 2
                            screenIndex = screenIndex + 1;
                        else
                            screenIndex = screenIndex + 1;
                        end
                    elseif bw == 1
                        screenIndex = screenIndex - 1;
                    end
                    WaitSecs(0.1);
                    
                case 3
                    if sumCannonDev >= 4
                        
                        header = 'Try it again!';
                        txt = ['In that block your shield was not '...
                            'always placed where the cannon was '...
                            'aiming. Remember: Placing your shield '...
                            'where the cannon is aimed will be the '...
                            'best way to earn money. Now try again. '];
                        
                        feedback = false;
                        fw = bigScreen(taskParam,...
                            taskParam.strings.txtPressEnter, header, txt,...
                            feedback);
                        if fw == 1
                            screenIndex = screenIndex - 1;
                        elseif bw == 1
                            screenIndex = screenIndex - 2;
                        end
                    else
                        
                        
                        header = 'Second Practice';
                        
                        txt = ['On some trials the ball will be fired '...
                            'from a different cannon that you cannot '...
                            'see. When this occurs the ball is equally '...
                            'likely to land at any location on the '...
                            'circle. However, these trials will be '...
                            'quite rare so your best strategy is still '...
                            'to place the shield where the cannon is '...
                            'aimed.\n\nPress Enter to see an example '...
                            'of this.'];
                        %end
                        feedback = false;
                        fw = bigScreen(taskParam,...
                            taskParam.strings.txtPressEnter, header,txt,...
                            feedback);
                        if fw == 1
                            screenIndex = screenIndex + 1;
                        elseif bw == 1
                            screenIndex = screenIndex - 2;
                        end
                        
                    end
                    WaitSecs(0.1);
                    
                case 4
                    txt=['Move the orange spot to the part of the '...
                        'circle, where the cannon is aimed and press '...
                        'SPACE.'];
                    
                    distMean = 290;
                    outcome = 170;
                    [taskParam, fw, bw, Data] = InstrLoopTxt(taskParam,...
                        txt, cannon, 'space', distMean);
                    LineAndBack(taskParam)
                    DrawCircle(taskParam);
                    DrawCross(taskParam);
                    PredictionSpot(taskParam);
                    DrawOutcome(taskParam, outcome);
                    Cannon(taskParam, distMean)
                    
                    %%%
                    
                    %% muss ich das ersetzen?
                    %DrawPE_Bar(taskParam, Data, 1)
                    
                    
                    %%
                    Screen('DrawingFinished',...
                        taskParam.gParam.window.onScreen);
                    t = GetSecs;
                    Screen('Flip',...
                        taskParam.gParam.window.onScreen, t + 0.1);
                    % Show baseline 1.
                    LineAndBack(taskParam)
                    DrawCross(taskParam)
                    DrawCircle(taskParam)
                    Screen('DrawingFinished',...
                        taskParam.gParam.window.onScreen, 1);
                    Screen('Flip', taskParam.gParam.window.onScreen,...
                        t + 0.6, 1);
                    while 1
                        txt=['In this case the cannonball was shot '...
                            'from a different cannon that you cannot '...
                            'see. Keep in mind that these trials will '...
                            'be quite rare so your best strategy is to '...
                            'place your shield where the cannon that '...
                            'you can see is aimed. \nPress enter to '...
                            'start the practice block.'];
                        LineAndBack(taskParam)
                        Cannon(taskParam, distMean)
                        DrawCircle(taskParam)
                        if subject.rew == 1
                            Shield(taskParam, 20, Data.pred, 1)
                        elseif subject.rew == 2
                            Shield(taskParam, 20, Data.pred, 0)
                        end
                        DrawOutcome(taskParam, outcome)
                        DrawFormattedText...
                            (taskParam.gParam.window.onScreen,txt,...
                            taskParam.gParam.screensize(3)*0.1,...
                            taskParam.gParam.screensize(4)*0.05,...
                            [255 255 255], sentenceLength);
                        DrawFormattedText...
                            (taskParam.gParam.window.onScreen,...
                            taskParam.strings.txtPressEnter,'center',...
                            taskParam.gParam.screensize(4)*0.9,...
                            [255 255 255]);
                        Screen('DrawingFinished',...
                            taskParam.gParam.window.onScreen, 1);
                        Screen('Flip',...
                            taskParam.gParam.window.onScreen, t + 1.6);
                        [ keyIsDown, ~, keyCode ] = KbCheck;
                        if keyIsDown
                            if keyCode(taskParam.keys.enter)
                                screenIndex = screenIndex + 1;
                                break
                            elseif keyCode(taskParam.keys.delete)
                                screenIndex = screenIndex - 3;
                                break
                            end
                        end
                    end
                    condition = 'practiceOddball';
                    LoadData = 'NoNoise';
%                     [taskParam, practData] = practLoop...
%                         (taskParam, subject, taskParam.gParam.haz(3),...
%                         taskParam.gParam.concentration(3), cannon,...
%                         condition, LoadData);
                    % added this (02.01.17) to get rid of practLoop
                    [taskParam, practData] =  main(taskParam,...
                        taskParam.gParam.haz(1),...
                        taskParam.gParam.concentration(3),...
                            condition, subject);                    

                    [txt, header] = AL_feedback(practData, taskParam,...
                        subject, condition);
                    feedback = true;
                    fw = bigScreen(taskParam,...
                        taskParam.strings.txtPressEnter,...
                        header, txt, feedback);
                    
                    WaitSecs(0.1);
                    
                case 5
                    sumCannonDev = sum(practData.cannonDev >= 10);
                    if sumCannonDev >= 4
                        
                        header = 'Wiederholung der Übung';
                        if isequal(taskParam.gParam.taskType, 'dresden')
                            txt = ['In der letzten Übung hast du dich '...
                                'zu häufig vom Ziel der Kanone '...
                                'wegbewegt. Du kannst mehr Kugeln '...
                                'fangen, wenn du immer auf dem Ziel '...
                                'der Kanone bleibst!\n\nIn der '...
                                'nächsten Runde kannst nochmal üben. '...
                                'Wenn du noch Fragen hast, kannst du '...
                                'dich auch an den Versuchsleiter wenden.'];
                        elseif isequal(taskParam.gParam.taskType,'oddball')
                            header = 'Try it again!';
                            txt = ['In that block your shield was not '...
                                'always placed where the cannon was '...
                                'aiming. Remember: Placing your shield '...
                                'where the cannon is aimed will be the '...
                                'best way to earn money. Now try '...
                                'again.'];
                        end
                        feedback = false;
                        fw = bigScreen(taskParam,...
                            taskParam.strings.txtPressEnter, header,txt,...
                            feedback);
                        if fw == 1
                            screenIndex = screenIndex - 1;
                        elseif bw == 1
                            screenIndex = screenIndex - 2;
                        end
                    else
                        screenIndex = screenIndex + 1;
                    end
                    
                    WaitSecs(0.1);
                case 6
                    
                    header = 'Third Practice';
                    
                    txt = ['In this block you will encounter a cannon '...
                        'that is not perfectly accurate. On some '...
                        'trials it might shoot a bit above where it is '...
                        'aimed and on other trials a bit below. '...
                        'Your best strategy is still to place the '...
                        'shield in the location where the cannon is '...
                        'aimed.\n\nThe cannon will still move '...
                        'unpredictably and balls will still '...
                        'occasionally be shot by another randomly '...
                        'aimed cannon.'];
                    feedback = false;
                    fw = bigScreen(taskParam, ...
                        taskParam.strings.txtPressEnter, header,...
                        txt, feedback);
                    if fw == 1
                        screenIndex = screenIndex + 1;
                    elseif bw == 1
                        screenIndex = screenIndex - 3;
                    end
                    
                    WaitSecs(0.1);
                case 7
                    
                    if isequal(taskParam.gParam.taskType, 'dresden')
                        LoadOddballPracticeNoNoise = true;
                        
%                         [taskParam, practData] = practLoop(taskParam,...
%                             subject, taskParam.gParam.haz(1),...
%                             taskParam.gParam.concentration(1),...
%                             cannon, condition, LoadOddballPracticeNoNoise);
                        % added this (02.01.17) to get rid of practLoop
                        [taskParam, practData] =  main(taskParam,...
                        taskParam.gParam.haz(1),...
                        taskParam.gParam.concentration(3),...
                            condition, subject);
                    elseif isequal(taskParam.gParam.taskType, 'oddball')
                        condition = 'practiceOddball';
                        LoadData = 'Noise';
%                         [taskParam, practData] = practLoop...
%                             (taskParam, subject,...
%                             taskParam.gParam.haz(3),...
%                             taskParam.gParam.concentration(1),...
%                             cannon, condition, LoadData);
                        % added this (02.01.17) to get rid of practLoop
                        [taskParam, practData] =  main(taskParam,...
                            taskParam.gParam.haz(1),...
                            taskParam.gParam.concentration(3),...
                                condition, subject);
                    end
                    
                    [txt, header] = AL_feedback(practData, taskParam,...
                        subject, condition);
                    
                    
                    feedback = true;
                    fw = bigScreen(taskParam,...
                        taskParam.strings.txtPressEnter, header,...
                        txt, feedback);
                    
                    if fw == 1
                        screenIndex = screenIndex + 1;
                    elseif bw == 1
                        screenIndex = screenIndex - 1;
                    end
                    WaitSecs(0.1);
                case 8
                    sumCannonDev = sum(practData.cannonDev >= 10);
                    if sumCannonDev >= 4
                        
                        header = 'Try it again!';
                        txt = ['In that block your shield was not '...
                            'always placed where the cannon was '...
                            'aiming. Remember: Placing your shield '...
                            'where the cannon is aimed will be the '...
                            'best way to earn money. Now try again.'];
                        
                        feedback = false;
                        fw = bigScreen(taskParam,...
                            taskParam.strings.txtPressEnter, header,txt,...
                            feedback);
                        if fw == 1
                            screenIndex = screenIndex - 1;
                        elseif bw == 1
                            screenIndex = screenIndex - 2;
                        end
                    else
                        screenIndex = screenIndex + 1;
                    end
                    
                    WaitSecs(0.1);
                case 9
                    
                    header = 'Fourth Practice';
                    txt = ['In this block everything will be '...
                        'exactly the same except that you will no '...
                        'longer see the cannon. The cannon is still '...
                        'aiming and shooting exactly as before. You '...
                        'will be paid for catching balls exactly as '...
                        'before. But now you must place your shield '...
                        'at the position where you think the cannon '...
                        'is aimed.\n\nSince you will still see each '...
                        'ball shot from the cannon, you will be able '...
                        'to use the locations of past shots to inform '...
                        'your decision.'];
                    
                    % end
                    feedback = false;
                    fw = bigScreen(taskParam,...
                        taskParam.strings.txtPressEnter, header,...
                        txt, feedback);
                    if fw == 1
                        screenIndex = screenIndex + 1;
                        
                    elseif bw == 1
                        screenIndex = screenIndex - 3;
                    end
                    
                    WaitSecs(0.1);
                case 10
                    break
            end
        end
    end

    function reversalPractice
        
        screenIndex = 1;
        
        while 1
            
            switch(screenIndex)
                
                case 1
                    
                    header = 'First Practice';
                    txt = ['You will now need to catch '...
                        'cannonballs shot from the cannon. '...
                        'The cannon will usually remain aimed '...
                        'at the same location. However, '...
                        'occasionally the cannon will be '...
                        'reaimed to a different '...'
                        'part of the circle.\n\nIf the cannon '...
                        'reaims its position, it will go back '...
                        'to its previous aim. To earn most '...
                        'money you should center your shield '...
                        'on the location at which the cannon '...
                        'is aimed.'];
                    
                    feedback = false;
                    fw = bigScreen(taskParam, ...
                        taskParam.strings.txtPressEnter, header,...
                        txt, feedback);
                    if fw == 1
                        screenIndex = screenIndex + 1; % 1
                    end
                    WaitSecs(0.1);
                    
                case 2
                    
                    condition = 'reversalPractice';
                    LoadData = 'reversalVisibleNoNoise';
                    
                    
%                     [taskParam, practData] = practLoop(taskParam,...
%                         subject, taskParam.gParam.haz(1),...
%                         taskParam.gParam.concentration(3), cannon,...
%                         condition, LoadData);
                    % added this (02.01.17) to get rid of practLoop
                    [taskParam, practData] =  main(taskParam,...
                        taskParam.gParam.haz(1),...
                        taskParam.gParam.concentration(3),...
                            condition, subject);
                    
                    [txt, header] = AL_feedback(practData, taskParam,...
                        subject, condition);
                    feedback = true;
                    fw = bigScreen(taskParam,...
                        taskParam.strings.txtPressEnter, header,...
                        txt, feedback);
                    sumCannonDev = sum(abs(practData.cannonDev) >= 10);
                    if fw == 1
                        
                        screenIndex = screenIndex + 1;
                        
                        
                    end
                    WaitSecs(0.1);
                    
                case 3
                    if sumCannonDev >= 4
                        
                        header = 'Try it again!';
                        txt = ['In that block your shield was not '...
                            'always placed where the cannon was '...
                            'aiming. Remember: Placing your shield '...
                            'where the cannon is aimed will be the '...
                            'best way to earn money. Now try again.'];
                        feedback = false;
                        fw = bigScreen(taskParam,...
                            taskParam.strings.txtPressEnter, header, txt,...
                            feedback);
                        if fw == 1
                            screenIndex = screenIndex - 1;
                        elseif bw == 1
                            screenIndex = screenIndex - 2;
                        end
                    else
                        
                        
                        header = 'Second Practice';
                        txt = ['In this block you will encounter a '...
                            'cannon that is not perfectly accurate. '...
                            'On some trials it might shoot a bit '...
                            'above where it is aimed and on other '...
                            'trials a bit below. Your best strategy '...
                            'is still to place the shield in the '...
                            'location where the cannon is aimed. If '...
                            'the cannon reaims its position, it will '...
                            'still go back to its previous aim.'];
                        
                        feedback = false;
                        fw = bigScreen(taskParam,...
                            taskParam.strings.txtPressEnter, header, txt,...
                            feedback);
                        if fw == 1
                            screenIndex = screenIndex + 1;
                        elseif bw == 1
                            screenIndex = screenIndex - 2;
                        end
                        
                    end
                    WaitSecs(0.1);
                    
                case 4
                    
                    condition = 'reversalPracticeNoise';
                    LoadData = 'reversalVisibleNoise';
                    
%                     [taskParam, practData] = practLoop(taskParam,...
%                         subject, taskParam.gParam.haz(1),...
%                         taskParam.gParam.concentration(1), cannon,...
%                         condition, LoadData);
                    % added this (02.01.17) to get rid of practLoop
                    [taskParam, practData] =  main(taskParam,...
                        taskParam.gParam.haz(1),...
                        taskParam.gParam.concentration(3),...
                            condition, subject);
                    
                    [txt, header] = AL_feedback(practData, taskParam,...
                        subject, condition);
                    feedback = true;
                    fw = bigScreen(taskParam,...
                        taskParam.strings.txtPressEnter, header,...
                        txt,feedback);
                    sumCannonDev = sum(abs(practData.cannonDev) >= 10);
                    if fw == 1
                        
                        screenIndex = screenIndex + 1;
                        
                        
                    end
                    WaitSecs(0.1);
                    
                case 5
                    if sumCannonDev >= 4
                        
                        header = 'Try it again!';
                        txt = ['In that block your shield was not '...
                            'always placed where the cannon was '...
                            'aiming. Remember: Placing your shield '...
                            'where the cannon is aimed will be the '...
                            'best way to earn money. Now try again.' ];
                        
                        feedback = false;
                        fw = bigScreen(taskParam,...
                            taskParam.strings.txtPressEnter, header,txt,...
                            feedback);
                        if fw == 1
                            screenIndex = screenIndex - 1;
                        elseif bw == 1
                            screenIndex = screenIndex - 2;
                        end
                    else
                        
                        
                        header = 'Third Practice';
                        
                        txt = ['In the next block everything will be '...
                            'exactly the same except that you will no '...
                            'longer see the cannon. The cannon is '...
                            'still aiming and shooting exactly as '...
                            'before. You will be paid for catching '...
                            'balls exactly as before. But now you must '...
                            'place your shield at the position where '...
                            'you think the cannon is aimed.\n\nSince '...
                            'you will still see each ball shot from '...
                            'the cannon, you will be able to use the '...
                            'locations of past shots to inform your '...
                            'decision.\n\nTo help you remember the '...
                            'previous aim of the cannon you can place '...
                            'a tickmark at the position where you '...
                            'think the cannon aimed previously.'...
                            '\n\nPress Enter to see an example of this.'];
                        
                        feedback = false;
                        fw = bigScreen(taskParam,...
                            taskParam.strings.txtPressEnter, header,txt,...
                            feedback);
                        if fw == 1
                            screenIndex = screenIndex + 1;
                        elseif bw == 1
                            screenIndex = screenIndex - 2;
                        end
                        
                    end
                    WaitSecs(0.1);
                    
                case 6
                    
                    txt=['To place your tickmark, move the orange spot '...
                        'to the part of the circle, where the cannon '...
                        'is aiming and hit the right mouse button. '...
                        'Take your time to try out how to set the '...
                        'tickmark a couple of times. Then indicate '...
                        'where you would like to place your shield to '...
                        'catch the next cannonball.'];
                    
                    distMean = 290;
                    outcome = 178;
                    tickInstruction.savedTickmark = nan;
                    tickInstruction.previousOutcome = nan;
                    tickInstruction.previousPrediction = nan;
                    cannon = true;
                    [taskParam, fw, Data, savedTickmark] =...
                        InstrLoopTxt(taskParam,...
                        txt, cannon, 'space', distMean, tickInstruction);
                    LineAndBack(taskParam)
                    DrawCircle(taskParam);
                    DrawCross(taskParam);
                    PredictionSpot(taskParam);
                    DrawOutcome(taskParam, outcome);
                    
                    if abs(Data.tickCannonDev) > 3 ...
                            || isnan(Data.tickCannonDev)
                        
                        header = 'Try it again!';
                        
                        if ~isnan(Data.tickCannonDev)
                            txt = ['In this case your tickmark was too '...
                                'far away from the cannon aim. '...
                                'Remember: Placing your '...
                                'tickmark where the cannon is aimed '...
                                'will be the best way to earn money. '...
                                'Now try again. '];
                        elseif isnan(Data.tickCannonDev)
                            txt = ['In this case you did not save your '...
                                'tickmark. Remember: Placing your '...
                                'tickmark where the cannon is aimed '...
                                'will be the best way to earn money. '...
                                'Now try again.'];
                        end
                        
                        feedback = false;
                        fw = bigScreen(taskParam,...
                            taskParam.strings.txtPressEnter, header,txt,...
                            feedback);
                        
                    else
                        
                        Screen('DrawingFinished',...
                            taskParam.gParam.window.onScreen);
                        t = GetSecs;
                        Screen('Flip',...
                            taskParam.gParam.window.onScreen, t + 0.1);
                        % Show baseline 1.
                        DrawCross(taskParam);
                        LineAndBack(taskParam)
                        DrawCross(taskParam)
                        DrawCircle(taskParam)
                        Screen('DrawingFinished',...
                            taskParam.gParam.window.onScreen, 1);
                        Screen('Flip',...
                            taskParam.gParam.window.onScreen, t + 0.6, 1);
                        
                        % Show baseline 1.
                        DrawCross(taskParam);
                        LineAndBack(taskParam)
                        DrawCross(taskParam)
                        DrawCircle(taskParam)
                        if subject.rew == 1
                            Shield(taskParam, 20, Data.pred, 1)
                        elseif subject.rew == 2
                            Shield(taskParam, 20, Data.pred, 0)
                        end
                        
                        DrawOutcome(taskParam, outcome)
                        
                        
                        Screen('DrawingFinished',...
                            taskParam.gParam.window.onScreen, 1);
                        Screen('Flip', taskParam.gParam.window.onScreen,...
                            t + 1.6, 1);
                        
                        % Show baseline 1.
                        DrawCross(taskParam);
                        LineAndBack(taskParam)
                        DrawCross(taskParam)
                        DrawCircle(taskParam)
                        Screen('DrawingFinished',...
                            taskParam.gParam.window.onScreen, 1);
                        Screen('Flip', taskParam.gParam.window.onScreen,...
                            t + 2.1, 1);
                        WaitSecs(1);
                        
                        while 1
                            txt=['In this case the cannon reaimed its '...
                                'postion. Your saved tickmark helps '...
                                'you to remember the previous aim of '...
                                'the cannon. When the cannon reaims '...
                                'again you should use your saved '...
                                'tickmark to quickly adapt your '...
                                'prediction. \nIn the next few trials '...
                                'you will not see the cannon anymore '...
                                'but you should still try to catch as '...
                                'many cannonballs as possible.'];
                            LineAndBack(taskParam)
                            DrawCross(taskParam)
                            DrawCircle(taskParam)
                            PredictionSpot(taskParam);
                            TickMark(taskParam, savedTickmark, 'saved');
                            DrawOutcome(taskParam, outcome)
                            DrawFormattedText...
                                (taskParam.gParam.window.onScreen,txt,...
                                taskParam.gParam.screensize(3)*0.1,...
                                taskParam.gParam.screensize(4)*0.05,...
                                [255 255 255], sentenceLength);
                            DrawFormattedText(...
                                taskParam.gParam.window.onScreen,...
                                taskParam.strings.txtPressEnter,...
                                'center',...
                                taskParam.gParam.screensize(4)*0.9,...
                                [255 255 255]);
                            Screen('DrawingFinished',...
                                taskParam.gParam.window.onScreen, 1);
                            Screen('Flip',...
                                taskParam.gParam.window.onScreen, t + 1.6);
                            [ keyIsDown, ~, keyCode ] = KbCheck;
                            if keyIsDown
                                if keyCode(taskParam.keys.enter)
                                    screenIndex = screenIndex + 1;
                                    break
                                elseif keyCode(taskParam.keys.delete)
                                    screenIndex = screenIndex - 3;
                                    break
                                end
                            end
                        end
                        
                        condition = 'reversalPracticeNoiseInv';
                        LoadData = 'None';
                        cannon = 'true';
                        reversalPackage = struct('savedTickmark',...
                            savedTickmark, 'pred', Data.pred,...
                            'outcome', outcome);
%                         [taskParam, practData, leaveLoop] = practLoop(taskParam,...
%                             subject, taskParam.gParam.haz(3),...
%                             taskParam.gParam.concentration(1),...
%                             cannon, condition, LoadData, reversalPackage);
                        % added this (02.01.17) to get rid of practLoop
                        [taskParam, practData] =  main(taskParam,...
                        taskParam.gParam.haz(1),...
                        taskParam.gParam.concentration(3),...
                            condition, subject);
                        
                        if leaveLoop
                            
                            header = 'Try it one more time!';
                            txt = ['In this case you updated your tickmark '...
                                'although the cannon did not change its aim. '...
                                'In the next round try to hold off for '...
                                'the tickmark while the cannon does not change.'];
                            
                            feedback = false;
                            fw = bigScreen(taskParam,...
                                taskParam.strings.txtPressEnter, header, txt,...
                                feedback);
                            screenIndex = 5;
                            if fw == 1
                                screenIndex = screenIndex + 1;
                            elseif bw == 1
                                screenIndex = screenIndex - 2;
                            end
                            
                        else
                            
                            txt=['In this case the cannon reaimed to its '...
                                'previous position. You can use your saved '...
                                'tickmark to inform your prediction and to '...
                                'avoid recalibrating your shield again.\n'...
                                'Before you indicate your prediction you '...
                                'should update your tickmark. Move the '...
                                'mouse to your last prediction (orange '...
                                'tickmark) and hit the right mouse button. '...
                                'Then indicate your prediction.'];
                            
                            distMean = practData.distMean(end);
                            outcome = practData.outcome(end);
                            tickInstructions.savedTickmark = practData.savedTickmark(end);
                            tickInstructions.previousOutcome = outcome;
                            tickInstructions.previousPrediction =...
                                practData.pred(end);
                            [taskParam, fw, Data, savedTickmark] =...
                                InstrLoopTxt(taskParam,...
                                txt, cannon, 'space', distMean,...
                                tickInstructions);
                            
                            tickDev = abs(tickInstructions.savedTickmark - Data.pred);
                            updatedTickDev = abs(practData.pred(end-1) - savedTickmark);
                            DrawCross(taskParam);
                            LineAndBack(taskParam)
                            DrawCross(taskParam)
                            DrawCircle(taskParam)
                            Screen('DrawingFinished',...
                                taskParam.gParam.window.onScreen, 1);
                            Screen('Flip', taskParam.gParam.window.onScreen,...
                                t + 2.1, 1);
                            WaitSecs(1);
                            
                            DrawCross(taskParam);
                            LineAndBack(taskParam)
                            DrawCross(taskParam)
                            DrawCircle(taskParam)
                            DrawOutcome(taskParam, outcome)
                            PredictionSpot(taskParam);
                            Screen('DrawingFinished',...
                                taskParam.gParam.window.onScreen, 1);
                            Screen('Flip', taskParam.gParam.window.onScreen,...
                                t + 3.1, 1);
                            WaitSecs(0.5);
                            
                            DrawCross(taskParam);
                            LineAndBack(taskParam)
                            DrawCross(taskParam)
                            DrawCircle(taskParam)
                            Screen('DrawingFinished',...
                                taskParam.gParam.window.onScreen, 1);
                            Screen('Flip', taskParam.gParam.window.onScreen,...
                                t + 2.1, 1);
                            WaitSecs(1);
                            
                            DrawCross(taskParam);
                            LineAndBack(taskParam)
                            DrawCross(taskParam)
                            DrawCircle(taskParam)
                            Shield(taskParam, 20, Data.pred, 1)
                            DrawOutcome(taskParam, outcome)
                            Screen('DrawingFinished',...
                                taskParam.gParam.window.onScreen, 1);
                            Screen('Flip',...
                                taskParam.gParam.window.onScreen, t + 3.1, 1);
                            WaitSecs(1);
                            
                        end
                    end
                    
                case 7
                    
                    if tickDev <= 10 && updatedTickDev <= 10 && ~isnan(updatedTickDev)
                        header = '';
                        txt = ['Well done! In this block you can practice '...
                            'the task with an invisible cannon. Keep in '...
                            'mind that the cannon occasionally reaims to '...
                            'its previous position. Use the red tickmark '...
                            'to mark the previous aim of the cannon.'];
                        
                        feedback = false;
                        fw = bigScreen(taskParam,...
                            taskParam.strings.txtPressEnter, header, txt,...
                            feedback);
                        if fw == 1
                            screenIndex = screenIndex + 1;
                        elseif bw == 1
                            screenIndex = screenIndex - 2;
                        end
                    elseif tickDev > 10
                        
                        header = 'Try again!';
                        txt = ['In this case you did not use the information '...
                            'of the tickmark for your current prediction. '...
                            'Keep in mind to use the tickmark '...
                            'this time!.'];
                        
                        feedback = false;
                        fw = bigScreen(taskParam,...
                            taskParam.strings.txtPressEnter, header, txt,...
                            feedback);
                        
                        if fw == 1
                            screenIndex = screenIndex - 1;
                            
                        end
                        
                    elseif updatedTickDev > 10 || isnan(updatedTickDev)
                        
                        header = 'Try again!';
                        txt = ['In this case you did not correctly update your '...
                            'tickmark after the cannon reaimed. Keep '...
                            'in mind to use the tickmark this time!'];
                        
                        feedback = false;
                        fw = bigScreen(taskParam,...
                            taskParam.strings.txtPressEnter, header, txt,...
                            feedback);
                        
                        if fw == 1
                            screenIndex = screenIndex - 1;
                            
                        end
                        
                    end
                    
                    WaitSecs(0.1);
                    
                case 8
                    
                    condition = 'reversalPracticeNoiseInv2';
                    LoadData = 'reversalNotVisibleNoise';
                    
                    cannon = false;
                    savedTickmark = nan;
                    
%                     [taskParam, practData] = practLoop(taskParam,...
%                         subject, taskParam.gParam.haz(1),...
%                         taskParam.gParam.concentration(1),...
%                         cannon, condition, LoadData);
                    % added this (02.01.17) to get rid of practLoop
                    [taskParam, practData] =  main(taskParam,...
                        taskParam.gParam.haz(1),...
                        taskParam.gParam.concentration(3),...
                            condition, subject);
                    
                    [txt, header] = AL_feedback(practData,...
                        taskParam, subject, condition);
                    feedback = true;
                    fw = bigScreen(taskParam, ...
                        taskParam.strings.txtPressEnter,...
                        header, txt, feedback);
                    sumCannonDev = sum(abs(practData.cannonDev) >= 10);
                    
                    
                    if fw == 1
                        screenIndex = screenIndex + 1;
                    end
                    WaitSecs(0.1);
                    
                case 9
                    
                    if isnan(practData.savedTickmark)
                        
                        header = 'Try it again!';
                        txt = ['In that block you have never used '...
                            'your tickmark. Remember: Placing '...
                            'your tickmark where the cannon was '...
                            'previously aimed will be the '...
                            'best way to earn money. Now try again.' ];
                        
                        
                        feedback = false;
                        fw = bigScreen(taskParam,...
                            taskParam.strings.txtPressEnter, header,txt,...
                            feedback);
                        if fw == 1
                            screenIndex = screenIndex - 1;
                        elseif bw == 1
                            screenIndex = screenIndex - 2;
                        end
                        
                    else
                        
                        header = 'Fourth Practice';
                        txt = ['Now comes the last practice block. In this '...
                            'block of trials the cannon will not always '...
                            'reaim to its previous target, but will '...
                            'occasionally aim at a new location on the '...
                            'circle. You can still use the red tickmark to '...
                            'mark the previous aim of the cannon. '...
                            'That is, if you realize that the cannon '...
                            'changed its aim you have to decide whether '...
                            'it reaimed to the previous location or '...
                            'whether it is aiming at a new location.'];
                        
                        feedback = false;
                        fw = bigScreen(taskParam,...
                            taskParam.strings.txtPressEnter, header, txt,...
                            feedback);
                        if fw == 1
                            screenIndex = screenIndex + 1;
                        elseif bw == 1
                            screenIndex = screenIndex - 2;
                        end
                        
                        
                        WaitSecs(0.1);
                    end
                    
                case 10
                    
                    break
                    
            end
        end
        
    end


    function chinesePractice
        
        screenIndex = 1; %1
        
        while 1
            
            switch(screenIndex)
                
                case 1
                    
                    header = 'Erste Übung';
                    
                    txt = ['Sehr gut! Du wurdest zum Beschützer der Galaxie '...
                        'ernannt und sollst nun zwei Planeten '...
                        'vor den Kanonenkugeln beschützen. Du kannst die '...
                        'Planeten deiner Galaxie anhand ihrer Farbe unterscheiden.\n\n'...
                        'Der Gegner hat auf jeden deiner Planeten '...
                        'genau eine Raumschiffkanone gerichtet. Die '...
                        'Positionen der Kanonen bleiben während '...
                        'eines Aufgabenblocks gleich. Es ist '...
                        'zufällig, welcher Planet gerade angegriffen '...
                        'wird. Es wird jedoch immer nur ein Planet '...
                        'zurzeit beschossen.\n\n'...
                        'Merke dir, auf welche Stelle der '...
                        'Gegner seine Kanone auf dem jeweiligen '...
                        'Planeten gerichtet hat. '...
                        'So kannst du bei einem Wechsel '...
                        'des Planeten dein Schild '...
                        'direkt an dieser Stelle positionieren. '...
                        'Um möglichst viele '...
                        'Kanonenkugeln abzuwehren, solltest du dein '...
                        'Schild auf jedem deiner Planeten immer '...
                        'genau an der Stelle positionieren, auf die '...
                        'der Gegner mit seiner Kanone zielt.'];
                    
                    feedback = false;
                    fw = bigScreen(taskParam, ...
                        taskParam.strings.txtPressEnter, header,...
                        txt, feedback);
                    
                    if fw == 1
                        screenIndex = screenIndex + 1;
                    end
                    WaitSecs(0.1);
                    
                case 2
                    
                    condition = 'chinesePractice_1';
                    %LoadData = 'CP_NoNoise';
                    
                    taskParam.gParam.nContexts = 1;
                    taskParam.gParam.nStates = 2;
%                     [taskParam, practData] = practLoop(taskParam,...
%                         subject, taskParam.gParam.haz(1),...
%                         taskParam.gParam.concentration(3),...
%                         cannon, condition);
                    % added this (02.01.17) to get rid of practLoop
                   % keyboard
                    [taskData, Data] =  main(taskParam,...
                        taskParam.gParam.haz(1),...
                        taskParam.gParam.concentration(3),...
                            condition, subject);
                    
%                     [txt, header] = AL_feedback(practData, taskParam,...
%                         subject, condition);
%                     feedback = true;
%                     fw = bigScreen(taskParam,...
%                         taskParam.strings.txtPressEnter,...
%                         header, txt, feedback);
                    
                   % if fw == 1
                        screenIndex = screenIndex + 1;
                    %elseif bw == 1
                     %   screenIndex = screenIndex - 1;
                    %end
                    WaitSecs(0.1);
                    
                case 3
                    
                    %screenIndex = performanceCriterion...
                    %    (screenIndex, practData);
                    sumCannonDev = sum(abs(taskData.cannonDev) >= 10);
                    
                    if sumCannonDev >= 4
                        
                        header = 'Wiederholung der Übung!';
                        txt = ['In der letzten Übung hast du dich zu '...
                            'häufig vom Ziel der Kanone wegbewegt. '...
                            'Du kannst mehr Raketen abwehren, wenn du '...
                            'immer auf dem Ziel der Kanone bleibst!'...
                            '\n\nIn der nächsten Runde kannst nochmal '...
                            'üben. Wenn du noch Fragen hast, kannst du '...
                            'dich auch an den Versuchsleiter wenden.'];
                        feedback = false;
                        fw = bigScreen(taskParam,...
                            taskParam.strings.txtPressEnter, header, txt,...
                            feedback);
                        if fw == 1
                            screenIndex = screenIndex - 1;
                        elseif bw == 1
                            screenIndex = screenIndex - 2;
                        end
                    else
                        
                        
                        header = 'Zweite Übung';
                        
                        txt = ['Aufgrund unterschiedlicher '...
                            'Gravitationskräfte in der Atmosphäre '...
                            'sind die Schüsse der Kanonen ungenau. '...
                            'Das heißt, auch wenn du genau auf das '...
                            'Ziel der Kanone gehst, kannst du die '...
                            'Kanonenkugeln verfehlen. Es ist zufällig, wie '...
                            'ungenau die Kanone ist. Deshalb wehrst du '...
                            'die meisten Kanonenkugeln ab, wenn du den '...
                            'orangenen Punkt genau auf der '...
                            'Stelle positionierst, auf die die jeweilige '...
                            'Kanone gerade zielt.\n\nIn der nächsten '...
                            'Übung sollst du mit der Ungenauigkeit '...
                            'der Kanonen vertraut werden. Lasse den '...
                            'orangenen Punkt immer auf der '...
                            'anvisierten Stelle der jeweiligen Kanone '...
                            'stehen. Wenn du deinen Punkt zu oft neben '...
                            'die anvisierte Stelle steuerst, wird die '...
                            'Übung wiederholt.'];
                        
                        feedback = false;
                        fw = bigScreen(taskParam,...
                            taskParam.strings.txtPressEnter, header, txt,...
                            feedback);
                        if fw == 1
                            screenIndex = screenIndex + 1;
                        end
                        
                    end
                    WaitSecs(0.1);
                    
                case 4
                     
                    %condition = 'chinesePracticeNoise';
                    condition = 'chinesePractice_2';
                    %LoadData = 'reversalVisibleNoise';
                    taskParam.gParam.nContexts = 1;
                    taskParam.gParam.nStates = 2;
                    
%                     [taskParam, practData] = practLoop(taskParam,...
%                         subject, taskParam.gParam.haz(1),...
%                         taskParam.gParam.concentration(1), cannon,...
%                         condition);

                    % added this (02.01.17) to get rid of practLoop
                    [taskData, Data] =  main(taskParam,...
                        taskParam.gParam.haz(1),...
                        taskParam.gParam.concentration(1),...
                            condition, subject);
                    
%                     [txt, header] = AL_feedback(practData, taskParam,...
%                         subject, condition);
%                     feedback = true;
%                     fw = bigScreen(taskParam,...
%                         taskParam.strings.txtPressEnter, header,...
%                         txt,feedback);
                    %sumCannonDev = sum(abs(taskData.memErr) >= 10);
                    sumCannonDev = sum(abs(taskData.cannonDev) >= 10);

                    %if fw == 1
                        
                        screenIndex = screenIndex + 1;
                        
                        
                    %end
                    WaitSecs(0.1);
                    
                case 5
                    if sumCannonDev >= 4
                        
                        header = 'Wiederholung der Übung!';
                        txt = ['In der letzten Übung hast du dich zu '...
                            'häufig vom Ziel der Kanone wegbewegt. '...
                            'Du kannst mehr Raketen abwehren, wenn du '...
                            'immer auf dem Ziel der Kanone bleibst!'...
                            '\n\nIn der nächsten Runde kannst nochmal '...
                            'üben. Wenn du noch Fragen hast, kannst du '...
                            'dich auch an den Versuchsleiter wenden.' ];
                        
                        feedback = false;
                        fw = bigScreen(taskParam,...
                            taskParam.strings.txtPressEnter, header,txt,...
                            feedback);
                        if fw == 1
                            screenIndex = screenIndex - 1;
                        elseif bw == 1
                            screenIndex = screenIndex - 2;
                        end
                    else
                        
                        
                        header = 'Dritte Übung';
                        
                        txt = ['Deine Planeten werden jetzt von '...
                            'zwei Gegnern beschossen. Du kannst die '...
                            'Gegner anhand ihrer Symbole voneinanander '...
                            'unterscheiden. Wie zuvor hat jeder Gegner auf '...
                            'jeden deiner Planeten genau eine Kanone gerichtet. '...
                            'Die Positionen der Kanonen bleiben '...
                            'während eines Aufgabenblocks gleich.\n\n'...
                            'Deine Planeten werden einige Zeit von dem selben '...
                            'Gegner beschossen. Gelegentlich wird '...
                            'jedoch auch der andere Gegner '...
                            'für einige Zeit auf deine Planeten '...
                            'schießen. Es ist vollkommen zufällig, '...
                            'welcher Gegner gerade deine Planeten '...
                            'beschießt. Die Planeten werden jedoch '...
                            'immer nur von einem Gegner zurzeit beschossen.\n\n'...
                            'Merke dir wieder, auf welche Stelle der '...
                            'jeweilige Gegner auf dem jeweiligen '...
                            'Planeten seine Kanone gerichtet hat. '...
                            'Du kannst dann bei einem Wechsel des '...
                            'Gegners oder des Planeten dein Schild '...
                            'direkt an dieser Stelle positionieren.'];
                        
                        feedback = false;
                        fw = bigScreen(taskParam,...
                            taskParam.strings.txtPressEnter, header,txt,...
                            feedback);
                        if fw == 1
                            screenIndex = screenIndex + 1;
                        elseif bw == 1
                            screenIndex = screenIndex - 2;
                        end
                        
                    end
                    WaitSecs(0.1);
                    
                case 6
                    %condition = 'chinesePracticeStateSpace';
                    condition = 'chinesePractice_3';

                    %LoadData = 'reversalNotVisibleNoise';
                    
                    cannon = true;
                    taskParam.symbol = true;
                    taskParam.gParam.nContexts = 2;
                    taskParam.gParam.nStates = 2;
%                     [taskParam, practData] = practLoop(taskParam,...
%                         subject, taskParam.gParam.haz(1),...
%                         taskParam.gParam.concentration(1),...
%                         cannon, condition);
                    % added this (02.01.17) to get rid of practLoop
                    [taskData, Data] =  main(taskParam,...
                        taskParam.gParam.haz(1),...
                        taskParam.gParam.concentration(1),...
                            condition, subject);
                    
%                     [txt, header] = AL_feedback(practData,...
%                         taskParam, subject, condition);
%                     feedback = true;
%                     fw = bigScreen(taskParam, ...
%                         taskParam.strings.txtPressEnter,...
%                         header, txt, feedback);
                    sumCannonDev = sum(abs(taskData.cannonDev) >= 10);
                    
                    
                    %if fw == 1
                        screenIndex = screenIndex + 1;
                    %end
                    WaitSecs(0.1);
                    
                case 7
                    
                    if sumCannonDev >= 4
                        
                        header = 'Wiederholung der Übung!';
                        txt = ['In der letzten Übung hast du dich zu '...
                            'häufig vom Ziel der Kanone wegbewegt. '...
                            'Du kannst mehr Raketen abwehren, wenn du '...
                            'immer auf dem Ziel der Kanone bleibst!'...
                            '\n\nIn der nächsten Runde kannst nochmal '...
                            'üben. Wenn du noch Fragen hast, kannst du '...
                            'dich auch an den Versuchsleiter wenden.' ];
                        
                        feedback = false;
                        fw = bigScreen(taskParam,...
                            taskParam.strings.txtPressEnter, header,txt,...
                            feedback);
                        if fw == 1
                            screenIndex = screenIndex - 1;
                        elseif bw == 1
                            screenIndex = screenIndex - 2;
                        end
                    else
                        
                        header = 'Vierte Übung';
                        
                        txt = ['Oh nein! Die gegnerischen Raumschiffe '...
                            'haben ihre Tarnfunktion aktiviert und sind '...
                            'jetzt unsichtbar. Du wirst die Kanonen der '...
                            'Gegner jetzt nicht mehr sehen können. '...
                            'Ansonsten bleibt alles so, wie du es '...
                            'schon geübt hast.\n\nDie Kanonen der '...
                            'Gegner zielen und schießen genau so wie '...
                            'vorher. Du verdienst weiterhin für jede '...
                            'abgewehrte Kanonenkugel Geld. Nun musst du aber '...
                            'herausfinden, wohin die unsichtbaren '...
                            'Kanonen zielen und dein Schild entsprechend '...
                            'positionieren. Du kannst die Stellen, '...
                            'an denen die Kanonenkugeln auf dem Planeten '...
                            'landen, als Information nutzen, um dein '...
                            'Schild zu positionieren.\n\nDu solltest '...
                            'dir wieder merken, auf welche Stelle der '...
                            'jeweilige Gegner auf dem jeweiligen '...
                            'Planeten seine Kanone gerichtet hat, '...
                            'auch wenn du die Kanonen jetzt nicht '...
                            'mehr sehen kannst. Du kannst dann bei '...
                            'einem Wechsel des Gegners oder des '...
                            'Planeten dein Schild direkt an dieser '...
                            'Stelle positionieren.'];
                        
                        feedback = false;
                        fw = bigScreen(taskParam,...
                            taskParam.strings.txtPressEnter, header, txt,...
                            feedback);
                        if fw == 1
                            screenIndex = screenIndex + 1;
                        elseif bw == 1
                            screenIndex = screenIndex - 2;
                        end
                        
                        
                        WaitSecs(0.1);
                    end
                    
                case 8
                    
                    break
                    
            end
            
        end
        
    end


    function FollowCannonJustInstructions
        if subject.cBal == 1 ...
                || subject.cBal == 2 ...
                || subject.cBal == 3
            screenIndex = 1;
        else
            screenIndex = 2;
            
        end
        while 1
            switch(screenIndex)
                
                
                case 1
                    
                    txt = 'Kanonenkugeln Abwehren';
                    screenIndex = YourTaskScreen(txt,...
                        taskParam.textures.shieldTxt, screenIndex);
                    
                case 2
                    if subject.cBal == 1 ...
                            || subject.cBal == 2 ...
                            || subject.cBal == 3
                        
                        header = 'Kanonenkugeln Abwehren';
                        
                        
                        if isequal(subject.group, '1')
                            
                            txt = ['In dieser Aufgabe ist das Ziel '...
                                'wieder möglichst viele Kanonenkugeln '...
                                'abzuwehren. Der Unterschied ist '...
                                'allerdings, dass du die Kanone dieses '...
                                'Mal sehen kannst.'];
                        else
                            
                            txt = ['In dieser Aufgabe ist das Ziel '...
                                'wieder möglichst viele Kanonenkugeln '...
                                'abzuwehren. Der Unterschied ist '...
                                'allerdings, dass Sie die Kanone '...
                                'dieses Mal sehen können.'];
                        end
                        
                        
                        feedback = false;
                        fw = bigScreen...
                            (taskParam,taskParam.strings.txtPressEnter, ...
                            header, txt, feedback);
                        if fw == 1
                            screenIndex = screenIndex + 1;
                            
                        elseif bw == 1
                            screenIndex = screenIndex - 3;
                        end
                    else
                        screenIndex = screenIndex + 1;
                    end
                    WaitSecs(0.1);
                    
                case 3
                    
                    if subject.cBal == 1 ...
                            || subject.cBal == 2 ...
                            || subject.cBal == 3
                        header = 'Erste Übung';
                    else
                        header = 'Dritte Übung';
                    end
                    
                    
                    
                    if isequal(subject.group, '1')...
                            && (subject.cBal == 4 ...
                            || subject.cBal == 6)
                        
                        txt = ['In dieser Aufgabe sollst du wieder '...
                            'versuchen möglichst viele Kanonenkugeln '...
                            'abzuwehren. Da du das Ziel der Kanone die '...
                            'ganze Zeit siehst, steuerst du dein '...
                            'Schild am besten genau auf die schwarze '...
                            'Nadel.\n\nBeachte allerdings, dass du '...
                            'jetzt nicht mehr sehen kannst wie die '...
                            'Kanonenkugel fliegt, sondern nur wo sie '...
                            'landet.'];
                    elseif isequal(subject.group, '1')...
                            && (subject.cBal == 1 ...
                            || subject.cBal == 2 ...
                            || subject.cBal == 3 ...
                            || subject.cBal == 5 )
                        txt = ['In dieser Aufgabe sollst du wieder '...
                            'versuchen möglichst viele Kanonenkugeln '...
                            'abzuwehren. Da du das Ziel der Kanone die '...
                            'ganze Zeit siehst, steuerst du dein '...
                            'Schild am besten genau auf die schwarze '...
                            'Nadel.'];
                    elseif isequal(subject.group, '2')...
                            && (subject.cBal == 4 ...
                            || subject.cBal == 6)
                        txt = ['In dieser Aufgabe sollen Sie wieder '...
                            'versuchen möglichst viele Kanonenkugeln '...
                            'abzuwehren. Da Sie das Ziel der Kanone '...
                            'die ganze Zeit sehen, steuern Sie Ihr '...
                            'Schild am besten genau auf die schwarze '...
                            'Nadel.\n\nBeachten Sie allerdings, dass '...
                            'Sie jetzt nicht mehr sehen können wie die '...
                            'Kanonenkugel fliegt, sondern nur wo sie '...
                            'landet.'];
                    elseif isequal(subject.group, '2')...
                            && (subject.cBal == 1 ...
                            || subject.cBal == 2 ...
                            || subject.cBal == 3 ...
                            || subject.cBal == 5 )
                        txt = ['In dieser Aufgabe sollen Sie wieder '...
                            'versuchen möglichst viele Kanonenkugeln '...
                            'abzuwehren. Da Sie das Ziel der Kanone '...
                            'die ganze Zeit sehen, steuern Sie Ihr '...
                            'Schild am besten genau auf die schwarze '...
                            'Nadel.'];
                    end
                    
                    feedback = false;
                    fw = bigScreen(taskParam,...
                        taskParam.strings.txtPressEnter, header, txt,...
                        feedback);
                    if fw == 1
                        screenIndex = screenIndex + 1;
                        
                    elseif bw == 1
                        screenIndex = screenIndex - 3;
                    end
                    
                    WaitSecs(0.1);
                    
                case 4
                    break
            end
        end
        
    end

    function MainJustInstructions
        
        screenIndex = 1;
        while 1
            switch(screenIndex)
                
                case 1
                    if subject.cBal == 4 ...
                            || subject.cBal == 6 ...
                            || subject.cBal == 5
                        txt = 'Kanonenkugeln Abwehren';
                        screenIndex = YourTaskScreen(txt,...
                            taskParam.textures.shieldTxt, screenIndex);
                    else
                        screenIndex = screenIndex + 1;
                    end
                    
                case 2
                    if subject.cBal == 4 || ...
                            subject.cBal == 6 ...
                            || subject.cBal == 5
                        
                        header = 'Kanonenkugeln Abwehren';
                        
                        
                        if isequal(subject.group, '1')
                            
                            txt = ['In dieser Aufgabe ist das Ziel '...
                                'wieder möglichst viele Kanonenkugeln '...
                                'abzuwehren. Der Unterschied ist '...
                                'allerdings, dass du die Kanone '...
                                'diesmal nur noch selten sehen kannst.'];
                        else
                            
                            txt = ['In dieser Aufgabe ist das Ziel '...
                                'wieder möglichst viele Kanonenkugeln '...
                                'abzuwehren. Der Unterschied ist '...
                                'allerdings, dass Sie die Kanone '...
                                'diesmal nur noch selten sehen können.'];
                        end
                        
                        
                        feedback = false;
                        fw = bigScreen...
                            (taskParam, taskParam.strings.txtPressEnter,...
                            header, txt, feedback);
                        if fw == 1
                            screenIndex = screenIndex + 1;
                            
                        elseif bw == 1
                            screenIndex = screenIndex - 3;
                        end
                    else
                        screenIndex = screenIndex + 1;
                    end
                    WaitSecs(0.1);
                case 3
                    
                    if isequal(taskParam.gParam.taskType, 'dresden')
                        if subject.cBal == 4 ...
                                || subject.cBal == 5 ...
                                || subject.cBal == 6
                            header = 'Erste Übung';
                        else
                            header = 'Dritte Übung';
                        end
                    else
                        header = 'Third Practice';
                    end
                    
                    if isequal(taskParam.gParam.taskType, 'dresden')
                        if isequal(subject.group, '1')
                            
                            txt = ['Bis jetzt kanntest du das Ziel '...
                                'der Kanone und du konntest die meisten '...
                                'Kugeln abwehren. Im nächsten '...
                                'Übungsdurchgang wird die Kanone in den '...
                                'meisten Fällen nicht '...
                                'mehr sichtbar sein. Anstelle der '...
                                'Kanone siehst dann ein Kreuz. '...
                                'Außerdem siehst du wo die '...
                                'Kanonenkugeln landen.\n\n'...
                                'Um weiterhin viele Kanonenkugeln '...
                                'abzuwehren, musst du aufgrund '...
                                'der Landeposition einschätzen, auf '...
                                'welche Stelle die Kanone zielt und '...
                                'den orangenen Punkt auf diese Position '...
                                'steuern. Wenn du denkst, dass die '...
                                'Kanone auf eine neue Stelle zielt, '...
                                'solltest du auch den orangenen Punkt '...
                                'dorthin bewegen.\n\nWenn du die '...
                                'Kanone siehst, steuerst du dein Schild '...
                                'am besten genau auf das Ziel der Kanone.'];
                        else
                            
                            txt = ['Bis jetzt kannten Sie das Ziel '...
                                'der Kanone und Sie konnten die meisten '...
                                'Kugeln abwehren. Im nächsten '...
                                'Übungsdurchgang wird die Kanone in den '...
                                'meisten Fällen nicht '...
                                'mehr sichtbar sein. Anstelle der '...
                                'Kanone sehen Sie dann ein Kreuz. '...
                                'Außerdem sehen Sie wo die '...
                                'Kanonenkugeln landen.\n\n'...
                                'Um weiterhin viele Kanonenkugeln '...
                                'abzuwehren, müssen Sie aufgrund '...
                                'der Landeposition einschätzen, auf '...
                                'welche Stelle die Kanone zielt und '...
                                'den orangenen Punkt auf diese Position '...
                                'steuern. Wenn Sie denken, dass die '...
                                'Kanone auf eine neue Stelle zielt, '...
                                'sollten Sie auch den orangenen Punkt '...
                                'dorthin bewegen.\n\nWenn Sie die '...
                                'Kanone sehen, steuern Sie Ihr Schild '...
                                'am besten genau auf das Ziel der Kanone.'];
                        end
                    else
                        txt = ['In this block everything will exactly '...
                            'be the same except that you will no '...
                            'longer see the cannon. The cannon is '...
                            'still aiming and shooting exactly as '...
                            'before. You will be paid for catching '...
                            'balls exactly as before. But now you '...
                            'must place your shield at the position '...
                            'where you think the cannon is aimed.\n\n'...
                            'Since you will see each ball shot from '...
                            'the cannon, you will be able to use '...
                            'the locations of past shots to inform '...
                            'your decision.'];
                    end
                    
                    feedback = false;
                    fw = bigScreen(taskParam,...
                        taskParam.strings.txtPressEnter, header, txt,...
                        feedback);
                    if fw == 1
                        screenIndex = screenIndex + 1;
                        
                    elseif bw == 1
                        screenIndex = screenIndex - 3;
                    end
                    
                    WaitSecs(0.1);
                    
                case 4
                    break
            end
        end
        
    end

    function FollowOutcomeInstructions
        
        screenIndex = 1;
        while 1
            switch(screenIndex)
                
                case 1
                    
                    txt = 'Kanonenkugeln Aufsammeln';
                    screenIndex = YourTaskScreen(txt,...
                        taskParam.textures.basketTxt, screenIndex);
                    
                case 2
                    
                    screenIndex = FirstCannonSlide(screenIndex);
                    
                case 3
                    
                    [screenIndex, Data] =...
                        PressSpaceToInitiateCannonShot...
                        (screenIndex, true);
                    
                case 4
                    
                    if isequal(subject.group, '1')
                        
                        txt=['Der schwarze Strich zeigt dir die '...
                            'Position der letzten Kugel. Der orangene '...
                            'Strich zeigt dir die Position deines '...
                            'letzten Korbes. Bewege den orangenen '...
                            'Punkt zur Stelle der letzten Kanonenkugel '...
                            'und drücke LEERTASTE um die Kugel '...
                            'aufzusammeln. '...
                            'Gleichzeitig schießt die Kanone dann eine '...
                            'neue Kugel ab.'];
                    else
                        
                        txt=['Der schwarze Strich zeigt Ihnen die '...
                            'Position der letzten Kugel. Der orangene '...
                            'Strich zeigt Ihnen die Position Ihres '...
                            'letzten Korbes. Bewegen Sie den orangenen '...
                            'Punkt zur Stelle der letzten Kanonenkugel '...
                            'und drücken Sie LEERTASTE um die Kugel '...
                            'aufzusammeln. Gleichzeitig schießt die '...
                            'Kanone dann eine neue Kugel ab.'];
                    end
                    Data.distMean = 35;
                    Data.outcome = 290;
                    [screenIndex, Data] = MoveSpotToLastOutcome...
                        (screenIndex, Data, txt);
                    
                case 5
                    
                    if isequal(subject.group, '1')
                        txt=['Der Korb erscheint nach dem Schuss. '...
                            'In diesem Fall hast du die Kanonenkugel '...
                            'mit dem Korb aufgesammelt. Wie du sehen '...
                            'kannst, hat die Kanone auch eine neue '...
                            'Kugel abgeschossen, die du im nächsten '...
                            'Durchgang aufsammeln kannst. Wenn '...
                            'mindestens die Hälfte der Kugel im Korb '...
                            'ist, zählt es als aufgesammelt.'];
                        
                    else
                        txt=['Der Korb erscheint nach dem Schuss. '...
                            'In diesem Fall haben Sie die Kanonenkugel '...
                            'mit dem Korb aufgesammelt. Wie Sie sehen '...
                            'können, hat die Kanone auch eine neue '...
                            'Kugel abgeschossen, die Sie im nächsten '...
                            'Durchgang aufsammeln können. Wenn '...
                            'mindestens die Hälfte der Kugel im '...
                            'Korb ist, zählt es als aufgesammelt.'];
                        
                    end
                    distMean = 35;
                    Data.distMean = 35;
                    Data.outcome = 35;
                    screenIndex =...
                        YouDidNotCollectTheCannonBall_TryAgain...
                        (screenIndex, Data, distMean, txt);
                    
                case 6
                    
                    if isequal(subject.group, '1')
                        txt=['Platziere den Korb jetzt wieder '...
                            'auf der Stelle der letzten Kanonenkugel '...
                            '(schwarzer Strich) und drücke LEERTASTE '...
                            'um die Kugel aufzusammeln.'];
                    else
                        
                        
                        txt=['Platzieren Sie den Korb jetzt wieder '...
                            'auf der Stelle der letzten Kanonenkugel '...
                            '(schwarzer Strich) und drücken Sie '...
                            'LEERTASTE um die Kugel aufzusammeln.'];
                    end
                    Data.distMean = 190;
                    Data.outcome = 35;
                    [screenIndex, Data] = MoveSpotToLastOutcome...
                        (screenIndex, Data, txt);
                    
                case 7
                    
                    if isequal(subject.group, '1')
                        
                        txt = ['Sehr gut! Du hast die vorherige '...
                            'Kanonenkugel wieder aufgesammelt.'];
                        
                    else
                        txt = ['Sehr gut! Sie haben die vorherige '...
                            'Kanonenkugel wieder aufgesammelt.'];
                        
                    end
                    distMean = 190;
                    Data.distMean = 190;
                    Data.outcome = 190;
                    screenIndex =...
                        YouDidNotCollectTheCannonBall_TryAgain...
                        (screenIndex, Data, distMean, txt);
                    
                case 8
                    
                    if isequal(subject.group, '1')
                        txt = sprintf(['Wenn du Kanonenkugeln '...
                            'aufsammelst, kannst du Geld verdienen. '...
                            'Wenn der Korb %s ist, verdienst du %s '...
                            'CENT wenn du die Kanonenkugel '...
                            'aufsammelst. Wenn der Korb %s ist, '...
                            'verdienst du nichts. Ebenso wie die '...
                            'Farbe, kann auch die Größe deines '...
                            'Korbes variieren. Die Farbe und die '...
                            'Größe des Korbes siehst du erst, '...
                            'nachdem die Kanone geschossen hat. '...
                            'Daher versuchst du am besten jede '...
                            'Kanonenkugel aufzusammeln.\n\nUm einen '...
                            'Eindruck von der wechselnden Größe '...
                            'und Farbe des Korbes zu bekommen, '...
                            'kommt jetzt eine kurze Übung.\n\n'],...
                            colRew, num2str(100*taskParam.gParam.rewMag),...
                            colNoRew);
                        
                    else
                        
                        txt = sprintf(['Wenn Sie Kanonenkugeln '...
                            'aufsammeln, können Sie Geld verdienen. '...
                            'Wenn der Korb %s ist, verdienen Sie %s '...
                            'CENT wenn Sie die Kanonenkugel '...
                            'aufsammeln. Wenn der Korb %s ist, '...
                            'verdienen Sie nichts. Ebenso wie die '...
                            'Farbe, kann auch die Größe Ihres Korbes '...
                            'variieren. Die Farbe und die Größe des '...
                            'Korbes sehen Sie erst, nachdem die Kanone '...
                            'geschossen hat. Daher versuchen Sie am '...
                            'besten jede Kanonenkugel aufzusammeln.'...
                            '\n\nUm einen Eindruck von der wechselnden '...
                            'Größe und Farbe des Korbes zu bekommen, '...
                            'kommt jetzt eine kurze Übung.\n\n'],...
                            colRew, num2str(100*taskParam.gParam.rewMag),...
                            colNoRew);
                        
                    end
                    [screenIndex, Data] = YourShield(screenIndex,Data,txt);
                    
                case 9
                    
                    screenIndex = ShieldPractice(screenIndex,whichPractice);
                    
                case 10
                    
                        screenIndex = TrialOutcomes(screenIndex);
                    
                case 11
                    
                    [screenIndex, Data] =...
                        PressSpaceToInitiateCannonShot(screenIndex, false);
                    
                case 12
                    
                    if isequal(subject.group, '1')
                        
                        
                        txt= ['Versuche die letzte Kanonenkugel jetzt '...
                            'wieder aufzusammeln (angezeigt durch den '...
                            'schwarzen Strich).'];
                    else
                        txt= ['Versuchen Sie bitte die letzte '...
                            'Kanonenkugel wieder aufzusammeln '...
                            '(angezeigt durch den schwarzen Strich).'];
                    end
                    Data.distMean = 35;
                    Data.outcome = 290;
                    [screenIndex, Data] = MoveSpotToLastOutcome...
                        (screenIndex, Data, txt);
                    
                case 13
                    
                    if isequal(subject.group, '1')
                        if isequal(whichPractice, 'followOutcomePractice')
                            txt = sprintf(['Weil du die Kanonenkugel '...
                                'aufgesammelt hast und der Korb %s war, '...
                                'hättest du jetzt %s CENT verdient.'],...
                                colRew, num2str...
                                (100*taskParam.gParam.rewMag));
                        else
                            txt = sprintf(['Weil du die Kanonenkugel '...
                                'aufgesammelt hast und das Schild %s '...
                                'war, hättest du jetzt %s CENT '...
                                'verdient.'], colRew,...
                                num2str(100*taskParam.gParam.rewMag));
                        end
                    else
                        if isequal(whichPractice, 'followOutcomePractice')
                            txt = sprintf(['Weil Sie die Kanonenkugel '...
                                'aufgesammelt haben und der Korb %s '...
                                'war, hätten Sie jetzt %s CENT '...
                                'verdient.'], colRew,...
                                num2str(100*taskParam.gParam.rewMag));
                        else
                            txt = sprintf(['Weil Sie die Kanonenkugel '...
                                'aufgesammelt haben und das Schild '...
                                '%s war, hätten Sie jetzt %s CENT '...
                                'verdient.'], colRew,...
                                num2str(100*taskParam.gParam.rewMag));
                        end
                    end
                    distMean = 35;
                    Data.distMean = 35;
                    Data.outcome = 35;
                    screenIndex =...
                        YouDidNotCollectTheCannonBall_TryAgain...
                        (screenIndex, Data, distMean, txt);
                    
                case 14
                    
                    if isequal(subject.group, '1')
                        
                        
                        txt= ['Versuche die letzte Kanonenkugel '...
                            'jetzt extra nicht aufzusammeln.'];
                    else
                        txt= ['Versuchen Sie bitte die letzte '...
                            'Kanonenkugel extra nicht aufzusammeln.'];
                    end
                    Data.distMean = 190;
                    Data.outcome = 35;
                    [screenIndex, Data] =...
                        MoveSpotToLastOutcome(screenIndex, Data, txt);
                    
                case 15
                    
                    Data.distMean = 190;
                    Data.outcome = 190;
                    win = true;
                    [screenIndex, Data] =...
                        YouCollectedTheCannonball_TryToMissIt...
                        (screenIndex, Data, win);
                    
                case 16
                    
                    if isequal(subject.group, '1')
                        txt= ['Versuche die letzte Kanonenkugel '...
                            'jetzt wieder aufzusammeln (angezeigt '...
                            'durch den schwarzen Strich).'];
                    else
                        txt= ['Versuchen Sie die letzte Kanonenkugel '...
                            'bitte wieder aufzusammeln (angezeigt '...
                            'durch den schwarzen Strich).'];
                    end
                    Data.distMean = 160;
                    Data.outcome = 190;
                    [screenIndex, Data] =...
                        MoveSpotToLastOutcome(screenIndex, Data, txt);
                    
                case 17
                    
                    [screenIndex, Data] =...
                        YouMissedTheCannonball_TryToCollectIt...
                        (screenIndex, Data);
                    
                case 18
                    
                    
                    if isequal(subject.group, '1')
                        
                        txt= ['Versuche die letzte Kanonenkugel jetzt '...
                            'extra nicht aufzusammeln.'];
                    else
                        txt= ['Versuchen Sie bitte die letzte '...
                            'Kanonenkugel nicht aufzusammeln.'];
                    end
                    Data.distMean = 10;
                    Data.outcome = 160;
                    [screenIndex, Data] =...
                        MoveSpotToLastOutcome(screenIndex, Data, txt);
                    
                case 19
                    
                    Data.distMean = 10;
                    Data.outcome = 10;
                    win = false;
                    [screenIndex, Data] =...
                        YouCollectedTheCannonball_TryToMissIt...
                        (screenIndex, Data, win);
                    
                case 20
                    
                    MainAndFollowCannon_CannonVisibleNoise
                    
                    screenIndex = screenIndex + 1;
                    
                case 21
                    
                    header = 'Zweite Übung';
                    
                    if isequal(subject.group, '1')
                        
                        txt=['Im nächsten '...
                            'Übungsdurchgang wird die Kanone meistens '...
                            'nicht mehr sichtbar sein. Anstelle der '...
                            'Kanone siehst du dann ein Kreuz, '...
                            'ansonsten bleibt alles gleich. '...
                            'Da du in dieser Aufgabe Kanonenkugeln '...
                            'aufsammelst, brauchst du nicht auf die '...
                            'Kanone zu achten.'];
                    else
                        
                        txt=['Im nächsten '...
                            'Übungsdurchgang wird die Kanone meistens '...
                            'nicht mehr sichtbar sein. Anstelle der '...
                            'Kanone sehen Sie dann ein Kreuz, '...
                            'ansonsten bleibt alles gleich. '...
                            'Da Sie in dieser Aufgabe Kanonenkugeln '...
                            'aufsammeln, brauchen Sie nicht auf die '...
                            'Kanone zu achten.'];
                    end
                    
                    feedback = false;
                    fw = bigScreen(taskParam, ...
                        taskParam.strings.txtPressEnter, header,...
                        txt, feedback);
                    if fw == 1
                        screenIndex = screenIndex + 1;
                    elseif bw == 1
                        screenIndex = screenIndex - 3;
                    end
                    
                    
                    WaitSecs(0.1);
                    
                case 22
                    
                    break
            end
        end
    end

%     function instructionsReversal
%
%     end

    function [screenIndex] = YourTaskScreen(txt, texture, screenIndex)
        while 1
            
            
            if isequal(taskParam.gParam.taskType, 'chinese')
                imageRect = [0 0 1440 900];
                dstRectTemp = CenterRect(imageRect, [0 0 1440 900]);
            else
                dstRectTemp = taskParam.textures.dstRect;
            end
            
            Screen('DrawTexture', taskParam.gParam.window.onScreen,...
                    texture,[], dstRectTemp)
            
            if ~isequal(taskParam.gParam.taskType, 'chinese')
                Screen('TextFont', taskParam.gParam.window.onScreen, 'Arial');
                Screen('TextSize', taskParam.gParam.window.onScreen, 30);
                DrawFormattedText(taskParam.gParam.window.onScreen, txt,...
                    'center', 100, [0 0 0], sentenceLength);
            end
            
            Screen('DrawingFinished', taskParam.gParam.window.onScreen);
            t = GetSecs;
            Screen('Flip', taskParam.gParam.window.onScreen, t + 0.1);
            [~, ~, keyCode] = KbCheck;
            if find(keyCode) == taskParam.keys.enter
                screenIndex = screenIndex + 1;
                break
            end
            
        end
        WaitSecs(0.1);
    end

    function [screenIndex] = FirstCannonSlide(screenIndex)
        
        WaitSecs(0.1);
        if isequal(taskParam.gParam.taskType, 'dresden')
            if isequal(whichPractice, 'mainPractice')...
                    || isequal(whichPractice, 'followCannonPractice')
                if isequal(subject.group, '1')
                    txt=['Eine Kanone zielt auf eine Stelle des '...
                        'Kreises. Deine Aufgabe ist es, die '...
                        'Kanonenkugel mit einem Schild abzuwehren. '...
                        'Mit dem orangenen Punkt kannst du angeben, '...
                        'wo du dein Schild platzieren möchtest, '...
                        'um die Kanonenkugel abzuwehren.\nDu kannst '...
                        'den Punkt mit den grünen und blauen '...
                        'Tasten steuern. Grün kannst du für schnelle '...
                        'Bewegungen und blau für langsame Bewegungen '...
                        'benutzen.'];
                else
                    txt=['Eine Kanone zielt auf eine Stelle des '...
                        'Kreises. Ihre Aufgabe ist es, die Kanonenkugel '...
                        'mit einem Schild abzuwehren. Mit dem orangenen '...
                        'Punkt können Sie angeben, wo Sie Ihr Schild '...
                        'platzieren möchten, um die Kanonenkugel '...
                        'abzuwehren.\nSie können den Punkt mit den '...
                        'grünen und blauen Tasten steuern. '...
                        'Grün können Sie für schnelle Bewegungen und '...
                        'blau für langsame Bewegungen benutzen.'];
                    
                end
            else
                if isequal(subject.group, '1')
                    txt=['Eine Kanone zielt auf eine Stelle des '...
                        'Kreises. Deine Aufgabe ist es, Kanonenkugeln '...
                        'mit einem Korb aufzusammeln. Mit dem orangenen '...
                        'Punkt kannst du angeben, '...
                        'wo du deinen Korb platzieren möchtest, um die '...
                        'Kanonenkugel aufzusammeln.\nDu kannst den '...
                        'Punkt mit den grünen und blauen Tasten '...
                        'steuern. Grün kannst du für schnelle '...
                        'Bewegungen und blau für langsame Bewegungen '...
                        'benutzen.'];
                else
                    txt=['Eine Kanone zielt auf eine Stelle des '...
                        'Kreises. Ihre Aufgabe ist es, Kanonenkugeln '...
                        'mit einem Korb aufzusammeln. Mit dem orangenen '...
                        'Punkt können Sie angeben, '...
                        'wo Sie Ihren Korb platzieren möchten, um die '...
                        'Kanonenkugeln aufzusammeln.\nSie können den '...
                        'Punkt mit den grünen und blauen Tasten '...
                        'steuern. Grün können Sie für schnelle '...
                        'Bewegungen und blau für langsame Bewegungen '...
                        'benutzen.'];
                end
            end
        elseif isequal(taskParam.gParam.taskType, 'oddball')
            txt=['A cannon is aimed at the circle. Indicate where '...
                'you would like to place your shield to catch '...
                'cannonballs with the orange spot. '...
                'You can move the orange spot with the green and yellow '...
                'buttons. Green is for fast movements and yellow is '...
                'for slow movements.'];
        elseif isequal(taskParam.gParam.taskType, 'reversal') ||...
                isequal(taskParam.gParam.taskType, 'ARC')
            txt=['A cannon is aimed at the circle. Indicate where '...
                'you would like to place your shield to catch '...
                'cannonballs with the orange spot. '...
                'You can move the orange spot using the mouse.'];
        elseif isequal(taskParam.gParam.taskType, 'chinese')
            txt=['Du bist die Weltraumpolizei und beschützt deinen Planeten.\n'...
                'Ein fremdes Raumschiff zielt mit seiner '...
                'Kanone auf eine Stelle deines Planeten und feuert '...
                'Kanonenkugeln. Deine Aufgabe ist es, die Kanonenkugel mit einem '...
                'Schild abzuwehren. Mit dem orangenen Punkt kannst du '...
                'angeben, wo du dein Schild platzieren möchtest, '...
                'um die Kanonenkugel abzuwehren. Du kannst den Punkt mit '...
                'der Maus bewegen. Das kannst du jetzt ausprobieren.'];
        end
        
        if isequal(taskParam.gParam.computer, 'Dresden')
            Screen('TextSize', taskParam.gParam.window.onScreen, 19);
        else
            Screen('TextSize', taskParam.gParam.window.onScreen, 30);
        end
        distMean = 300;
        outcome = 300;
        taskParam.symbol = false;
        tickInstruction.savedTickmark = nan;
        tickInstruction.previousOutcome = nan;
        DrawFormattedText(taskParam.gParam.window.onScreen,...
            taskParam.strings.txtPressEnter,'center',...
            taskParam.gParam.screensize(4)*0.9);
        [taskParam, fw, Data, ~] = instrLoopTxt(taskParam,...
            txt, cannon, 'arrow', distMean, tickInstruction);
        if fw == 1
            screenIndex = screenIndex + 1;
        elseif bw == 1
            screenIndex = screenIndex - 1;
        end
        WaitSecs(0.1);
    end

    function [screenIndex, Data] =...
            MoveSpotToCannonAim(screenIndex, txt, distMean, Data)
        
        t = GetSecs;
        lineAndBack(taskParam)
        if isequal(taskParam.gParam.taskType, 'chinese')
            currentContext = 1;
            drawContext(taskParam, currentContext)
        end
        drawCross(taskParam)
        drawCircle(taskParam)
        Screen('DrawingFinished', taskParam.gParam.window.onScreen, 1);
        Screen('Flip', taskParam.gParam.window.onScreen, t + 0.1, 1);
        WaitSecs(0.5);
        
        Data.tickMark = true;
        Data.distMean = distMean;
        tickInstruction.savedTickmark = nan;
        tickInstruction.previousOutcome = nan;
        [taskParam, fw, Data, savedTickmark] = instrLoopTxt(taskParam,...
            txt, cannon, 'space', distMean, tickInstruction, Data);
        if fw == 1
            screenIndex = screenIndex + 1;
        end
        WaitSecs(0.1);
    end

    function [screenIndex, Data] =...
            YouMissedTheCannonBall_TryAgain(screenIndex, Data, distMean)
        
        outcome = distMean;
        Data.outcome = distMean;
        background = true;
        cannonball(taskParam, distMean, outcome, background, 1, 0)
        if (isequal(whichPractice, 'mainPractice')...
                && Data.predErr >= 9)...
                || (isequal(whichPractice, 'followCannonPractice')...
                && Data.predErr >= 9)...
                || (isequal(whichPractice, 'oddballPractice')...
                && Data.predErr >= 9)...
                || (isequal(whichPractice, 'reversal')...
                && abs(Data.predErr) >= 9)...
                || (isequal(whichPractice, 'chinese')...
                && abs(Data.predErr) >= 9)
            if isequal(taskParam.gParam.taskType, 'dresden')
                if isequal(subject.group, '1')
                    txt=['Leider hast du die Kanonenkugel vefehlt. '...
                        'Versuche es noch einmal!'];
                else
                    txt=['Leider haben Sie die Kanonenkugel vefehlt. '...
                        'Versuchen Sie es bitte noch einmal!'];
                end
            elseif isequal(taskParam.gParam.taskType, 'oddball')...
                    || isequal(taskParam.gParam.taskType, 'reversal')
                txt=['You missed the cannonball. '...
                    'Try it again!'];
            elseif isequal(taskParam.gParam.taskType, 'chinese')...
                    txt=['Du hast die Kanonenkugel verfehlt. Versuche es nochmal!'];
            end
            
            lineAndBack(taskParam)
            if isequal(taskParam.gParam.taskType, 'chinese')
                currentContext = 1;
                DrawContext(taskParam, currentContext)
            end
            
            drawCircle(taskParam);
            drawCross(taskParam);
            PredictionSpot(taskParam);
            DrawOutcome(taskParam, outcome);
            Cannon(taskParam, distMean, 0)
            
            DrawFormattedText(taskParam.gParam.window.onScreen,...
                taskParam.strings.txtPressEnter,'center',...
                taskParam.gParam.screensize(4)*0.9, [255 255 255]);
            DrawFormattedText(taskParam.gParam.window.onScreen,txt,...
                taskParam.gParam.screensize(3)*0.1,...
                taskParam.gParam.screensize(4)*0.05,...
                [255 255 255], sentenceLength);
            Screen('DrawingFinished', taskParam.gParam.window.onScreen);
            t = GetSecs;
            Screen('Flip', taskParam.gParam.window.onScreen, t + 0.1);
            while 1
                [ keyIsDown, ~, keyCode ] = KbCheck;
                if keyIsDown
                    if keyCode(taskParam.keys.enter)
                        screenIndex = screenIndex - 1;
                        break
                    elseif keyCode(taskParam.keys.delete)
                        screenIndex = screenIndex - 2;
                        break
                    end
                end
            end
        else
            screenIndex = screenIndex + 1;
        end
        WaitSecs(0.1);
        
    end

    function [screenIndex, Data] =...
            AfterCannonIsShotYouSeeTheShield...
            (screenIndex, Data, txt, distMean, win)
           
        outcome = distMean;
        lineAndBack(taskParam)
        drawCircle(taskParam);
        if isequal(taskParam.gParam.taskType, 'chinese')
            currentContext = 1;
            drawContext(taskParam, currentContext)
        end
        drawCross(taskParam);
        predictionSpot(taskParam);
        drawOutcome(taskParam, outcome);
        drawCannon(taskParam, distMean, 0)
        Screen('DrawingFinished', taskParam.gParam.window.onScreen);
        t = GetSecs;
        Screen('Flip', taskParam.gParam.window.onScreen, t + 0.1);
        lineAndBack(taskParam)
        if isequal(taskParam.gParam.taskType, 'chinese')
            currentContext = 1;
            drawContext(taskParam, currentContext)
        end
        drawCross(taskParam)
        drawCircle(taskParam)
        Screen('DrawingFinished', taskParam.gParam.window.onScreen, 1);
        Screen('Flip', taskParam.gParam.window.onScreen, t + 0.6, 1);
        while 1
            
            lineAndBack(taskParam)
            drawCannon(taskParam, distMean, 0)
            drawCircle(taskParam)
            if isequal(taskParam.gParam.taskType, 'chinese')
                currentContext = 1;
                drawContext(taskParam, currentContext)
                drawCross(taskParam);
            end
            if (subject.rew == 1 && win) || (subject.rew == 2 && ~win)
                shield(taskParam, 20, Data.pred, 1)
            elseif (subject.rew == 2 && win) || (subject.rew == 1 && ~win)
                shield(taskParam, 20, Data.pred, 0)
                
            end
            drawOutcome(taskParam, outcome)
            DrawFormattedText(taskParam.gParam.window.onScreen,txt,...
                taskParam.gParam.screensize(3)*0.1,...
                taskParam.gParam.screensize(4)*0.05,...
                [255 255 255], sentenceLength);
            DrawFormattedText(taskParam.gParam.window.onScreen,...
                taskParam.strings.txtPressEnter,'center',...
                taskParam.gParam.screensize(4)*0.9, [255 255 255]);
            Screen('DrawingFinished', taskParam.gParam.window.onScreen, 1);
            Screen('Flip', taskParam.gParam.window.onScreen, t + 1.6);
            
            [ keyIsDown, ~, keyCode ] = KbCheck;
            if keyIsDown
                if keyCode(taskParam.keys.enter)
                    screenIndex = screenIndex + 1;
                    break
                elseif keyCode(taskParam.keys.delete)
                    screenIndex = screenIndex - 3;
                    break
                end
            end
        end
        
        WaitSecs(0.1);
        
    end

    function [screenIndex, Data] = TryToMissTheCannon...
            (screenIndex, Data, txt, distMean)
        
        t = GetSecs;
        lineAndBack(taskParam)
        if isequal(taskParam.gParam.taskType, 'chinese')
            currentContext = 1;
            drawContext(taskParam, currentContext)
            drawCross(taskParam);
        end
        drawCross(taskParam)
        drawCircle(taskParam)
        Screen('DrawingFinished', taskParam.gParam.window.onScreen, 1);
        Screen('Flip', taskParam.gParam.window.onScreen, t + 0.1, 1);
        WaitSecs(0.5);
        Data.tickMark = true;
        Data.distMean = distMean;
        outcome = distMean;
        Data.tickMark = true;
        tickInstruction.savedTickmark = nan;
        tickInstruction.previousOutcome = nan;
        [taskParam, fw, Data] = instrLoopTxt(taskParam, txt,...
            cannon, 'space', distMean, tickInstruction, Data);
        if fw == 1
            screenIndex = screenIndex + 1;
        end
        
        WaitSecs(0.1);
    end

    function [screenIndex, Data, t] =...
            YouCaughtTheCannonball_TryToMissIt(screenIndex, Data, distMean)
        
        outcome = Data.outcome;
        background = true;
        cannonball(taskParam, distMean, outcome, background, 1, 0)
        
        if abs(Data.predErr) <= 9
            while 1
                if isequal(taskParam.gParam.taskType, 'dresden')
                    if isequal(subject.group, '1')
                        
                        txt=['Du hast die Kanonenkugel abgewehrt. '...
                            'Versuche die Kanonenkugel diesmal zu '...
                            'verpassen!'];
                    else
                        
                        txt=['Sie haben die Kanonenkugel abgewehrt. '...
                            'Versuchen Sie die Kanonenkugel diesmal '...
                            'bitte zu verpassen!'];
                    end
                elseif isequal(taskParam.gParam.taskType, 'oddball')...
                        || isequal(taskParam.gParam.taskType, 'reversal')...
                        || isequal(taskParam.gParam.taskType, 'ARC')
                    txt=['You caught the cannonball. '...
                        'Try to miss it!'];
                elseif isequal(taskParam.gParam.taskType, 'chinese')
                    txt=['Du hast die Kanonenkugel abgewehrt! '...
                        'Versuche sie zu verfehlen!'];
                end
                lineAndBack(taskParam)
                drawCircle(taskParam);
                
               
                if isequal(taskParam.gParam.taskType, 'chinese')
                    currentContext = 1;
                    drawContext(taskParam, currentContext)
                    
                end
                drawCross(taskParam);
                predictionSpot(taskParam);
                drawOutcome(taskParam, outcome);
                drawCannon(taskParam, distMean, 0)
                DrawFormattedText(taskParam.gParam.window.onScreen,...
                    taskParam.strings.txtPressEnter,'center',...
                    taskParam.gParam.screensize(4)*0.9, [255 255 255]);
                DrawFormattedText(taskParam.gParam.window.onScreen,txt,...
                    taskParam.gParam.screensize(3)*0.1,...
                    taskParam.gParam.screensize(4)*0.05,...
                    [255 255 255], sentenceLength);
                Screen('DrawingFinished', taskParam.gParam.window.onScreen);
                t = GetSecs;
                Screen('Flip', taskParam.gParam.window.onScreen, t + 0.1);
                [ keyIsDown, ~, keyCode ] = KbCheck;
                if keyIsDown
                    if keyCode(taskParam.keys.enter)
                        screenIndex = screenIndex - 1 ;
                        break
                    elseif keyCode(taskParam.keys.delete)
                        screenIndex = screenIndex - 5;
                        break
                    end
                end
            end
        else
            if isequal(taskParam.gParam.taskType, 'dresden')
                if isequal(subject.group, '1')
                    
                    txt=['Der schwarze Balken zeigt dir '...
                        'wie weit die Kanonenkugel von deinem '...
                        'Punkt entfernt war. Daraufhin siehst du dann...'];
                else
                    txt=['Der schwarze Balken zeigt Ihnen '...
                        'wie weit die Kanonenkugel von Ihrem '...
                        'Punkt entfernt war. Daraufhin siehst du dann...'];
                end
            elseif isequal(taskParam.gParam.taskType, 'oddball')
                txt=['Der schwarze Balken zeigt dir '...
                    'wie weit die Kanonenkugel von deinem '...
                    'Punkt entfernt war. Daraufhin siehst du dann...'];
            end
            lineAndBack(taskParam)
            drawCircle(taskParam);
            if isequal(taskParam.gParam.taskType, 'chinese')
                currentContext = 1;
                drawContext(taskParam, currentContext)
                drawCross(taskParam);
            end
            drawCross(taskParam);
            predictionSpot(taskParam);
            drawOutcome(taskParam, outcome);
            drawCannon(taskParam, distMean, 0)
            Screen('DrawingFinished', taskParam.gParam.window.onScreen);
            t = GetSecs;
            Screen('Flip', taskParam.gParam.window.onScreen, t + 0.1);
            screenIndex = screenIndex + 1;
        end
        
        WaitSecs(0.1);
        
    end

    function [screenIndex, Data, t] =...
            InThisCaseYouMissedTheCannonball(screenIndex, Data, t, txt,...
            distMean, win)
        
        outcome = distMean;
        lineAndBack(taskParam)
        if isequal(taskParam.gParam.taskType, 'chinese')
            currentContext = 1;
            drawContext(taskParam, currentContext)
            drawCross(taskParam);
        end
        drawCross(taskParam)
        drawCircle(taskParam)
        Screen('DrawingFinished', taskParam.gParam.window.onScreen, 1);
        Screen('Flip', taskParam.gParam.window.onScreen, t + 0.6, 1);
        while 1
            
            lineAndBack(taskParam)
            if isequal(taskParam.gParam.taskType, 'chinese')
                currentContext = 1;
                drawContext(taskParam, currentContext)
                drawCross(taskParam);
            end
            drawCannon(taskParam, distMean, 0)
            drawCircle(taskParam)
            if (subject.rew == 1 && win) || (subject.rew == 2 && ~win)
                shield(taskParam, 20, Data.pred, 1)
            elseif (subject.rew == 2 && win) || (subject.rew == 1 && ~win)
                shield(taskParam, 20, Data.pred, 0)
            end
            drawOutcome(taskParam, outcome)
            DrawFormattedText(taskParam.gParam.window.onScreen,txt,...
                taskParam.gParam.screensize(3)*0.1,...
                taskParam.gParam.screensize(4)*0.05,...
                [255 255 255], sentenceLength);
            DrawFormattedText(taskParam.gParam.window.onScreen,...
                taskParam.strings.txtPressEnter,'center',...
                taskParam.gParam.screensize(4)*0.9, [255 255 255]);
            Screen('DrawingFinished', taskParam.gParam.window.onScreen, 1);
            Screen('Flip', taskParam.gParam.window.onScreen, t + 1.2);
            
            [ keyIsDown, ~, keyCode ] = KbCheck;
            if keyIsDown
                if keyCode(taskParam.keys.enter)
                    screenIndex = screenIndex + 1;
                    break
                elseif keyCode(taskParam.keys.delete)
                    screenIndex = screenIndex - 6;
                    break
                end
            end
        end
        WaitSecs(0.1);
    end

    function [screenIndex, Data] = YourShield(screenIndex, Data, txt)
        if isequal(taskParam.gParam.taskType, 'dresden')
            if isequal(whichPractice, 'followOutcomePractice')
                header = 'Der Korb';
                
            else
                header = 'Das Schild';
            end
            
        elseif isequal(taskParam.gParam.taskType, 'oddball')...
                || isequal(taskParam.gParam.taskType, 'reversal')
            header = 'Your Shield';
            if subject.rew == 1
                colRew = 'blue';
                colNoRew = 'green';
            elseif subject.rew == 2
                colRew = 'green';
                colNoRew = 'blue';
            end
            txt = sprintf(['You can earn money by catching '...
                'cannonballs in your shield. If the shield '...
                'is %s you will earn %s CENTS for catching '...
                'the ball. If the shield is %s you will not '...
                'earn anything. On some trials the shield '...
                'will be large and on some trials it will '...
                'be small. You cannot know the SIZE or '...
                'COLOR of the shield until the cannon '...
                'is fired so it is best to try to catch '...
                'the ball on every trial.\n\n'...
                'You will now have some practice to get a '...
                'sense of how the color and size of '...
                'the shield vary.\n\nThe location of the '...
                'ball fired on the previous trial will be '...
                'marked with a black line.\n\nMoreover, '...
                'the location of the orange spot from the '...
                'previous trial will be marked with an '...
                'orange line.'],...
                colRew, num2str(100*taskParam.gParam.rewMag), colNoRew);
            
        elseif isequal(taskParam.gParam.taskType, 'chinese')
            header = 'Dein Schild';
            if subject.rew == 1
                colRew = 'schwarz';
                colNoRew = 'green';
            elseif subject.rew == 2
                colRew = 'green';
                colNoRew = 'blue';
            end
            txt = sprintf(['Wenn du die Kanonenkugeln abwehrst, verdienst du '...
                'Geld. Du verdienst %s Cent für jede abgewehrte Kanonenkugel. '...
                'Dieses Geld wird dir am Ende '...
                'des Experiments ausgezahlt.\n\nDie Größe deines Schildes '...
                'kann sich in jedem Durchgang verändern. Die Größe '...
                'des Schildes siehst du jedoch erst, nachdem die '...
                'Kanone geschossen hat. Daher solltest du versuchen, '...
                'dein Schild so genau wie möglich zu positionieren, '...
                'um so viele Kanonenkugeln wie möglich abzuwehren.\n\nUm einen '...
                'Eindruck von der wechselnden Größe des Schildes zu '...
                'bekommen, folgt jetzt eine kurze Übung.'],...
                num2str(100*taskParam.gParam.rewMag));
            
        elseif isequal(taskParam.gParam.taskType, 'ARC')
           header = 'Your Shield';
            
            txt = sprintf(['You can earn money by catching '...
                'cannonballs in your shield. On some trials '...
                'the shield will be large and on some trials it will '...
                'be small. You cannot know the size of the shield '...
                'until the cannon is fired so it is best to '...
                'try to catch the ball on every trial.\n\n'...
                'You will now have some practice to get a '...
                'sense of how the size of the shield varies.'...
                '\n\nThe location of the ball fired on the '...
                'previous trial will be marked with a black '...
                'line.\n\nMoreover, the location of the orange '...
                'spot from the previous trial will be marked with an '...
                'orange line.'],...
                'schwarz', num2str(100*taskParam.gParam.rewMag), 'schwarz');
        end
        
        feedback = false;
        fw = bigScreen(taskParam,...
            taskParam.strings.txtPressEnter, header, txt, feedback);
        if fw == 1
            screenIndex = screenIndex + 1;
        elseif bw == 1
            screenIndex = screenIndex - 7;
        end
        WaitSecs(0.1);
        
    end

    function [screenIndex, Data] =...
            ShieldPractice(screenIndex, whichPractice)
        
        condition = 'shield';
        
        if (isequal(whichPractice, 'mainPractice'))...
                || (isequal(whichPractice, 'followCannonPractice'))...
                || (isequal(whichPractice, 'oddballPractice'))...
                || (isequal(whichPractice, 'chinese'))
            haz = taskParam.gParam.haz(3);
        else
            haz = taskParam.gParam.haz(2);
        end
        
%         [taskParam, Data] = practLoop(taskParam, subject,...
%             haz, taskParam.gParam.concentration(3), cannon, condition);
                    % added this (02.01.17) to get rid of practLoop
                   % taskParam.gParam

                    [taskData, Data] =  main(taskParam,...
                        taskParam.gParam.haz(2),...
                        taskParam.gParam.concentration(3),...
                            condition, subject);
        screenIndex = screenIndex + 1;
        WaitSecs(0.1);
    end

    function [screenIndex] = TrialOutcomes(screenIndex)
        if isequal(taskParam.gParam.taskType, 'dresden')
            header = 'Gewinnmöglichkeiten';
            if isequal(subject.group, '1')
                
                txt = ['Um dir genau zu zeigen, wann du Geld '...
                    'verdienst, spielen wir jetzt alle Möglichkeiten '...
                    'durch.'];
            else
                txt = ['Um Ihnen genau zu zeigen, wann Sie Geld '...
                    'verdienen, spielen wir jetzt alle Möglichkeiten '...
                    'durch.'];
            end
        elseif isequal(taskParam.gParam.taskType, 'oddball')...
                || isequal(taskParam.gParam.taskType, 'reversal')...
                || isequal(taskParam.gParam.taskType, 'ARC')
            header = 'Trial Outcomes';
            txt = sprintf(['Now lets see what happens when you hit '...
                'or miss the ball with a %s or %s shield...'],...
                colRew, colNoRew);
        end
        feedback = false;
        fw = bigScreen(taskParam,...
            taskParam.strings.txtPressEnter, header, txt, feedback);
        if fw == 1
            screenIndex = screenIndex + 1;
        elseif bw == 1
            screenIndex = screenIndex - 2;
        end
        WaitSecs(0.1);
    end

    function [screenIndex, Data] = PressSpaceToInitiateCannonShot...
            (screenIndex, introduceNeedle)
        if introduceNeedle
            
            if isequal(taskParam.gParam.taskType, 'dresden')
                
                if isequal(subject.group, '1')
                    
                    
                    txt=['Das Ziel der Kanone wird mit der '...
                        'schwarzen Nadel angezeigt. Drücke LEERTASTE, '...
                        'damit die Kanone schießt.'];
                    
                else
                    txt=['Das Ziel der Kanone wird mit der '...
                        'schwarzen Nadel angezeigt. Drücke Sie bitte '...
                        'LEERTASTE, damit die Kanone schießt.'];
                    
                end
                
            elseif isequal(taskParam.gParam.taskType, 'oddball') 
                txt = ['The aim of the cannon is indicated with the '...
                    'black line. Hit SPACE to initiate a cannon shot.'];
            elseif isequal(taskParam.gParam.taskType, 'reversal') ||...
                    isequal(taskParam.gParam.taskType, 'ARC')
                txt = ['The aim of the cannon is indicated with the '...
                    'black line. Hit the left mouse button to '...
                    'initiate a cannon shot.'];
            elseif isequal(taskParam.gParam.taskType, 'chinese')
                txt = ['Das Ziel der Kanone wird mit der schwarzen '...
                    'Linie angezeigt. Drücke die linke '...
                    'Maustaste, damit die Kanone schießt.'];
                
            end
        else
            if isequal(subject.group, '1')
                
                txt=['Drücke LEERTASTE, '...
                    'damit die Kanone schießt.'];
            else
                txt=['Drücken Sie bitte LEERTASTE, '...
                    'damit die Kanone schießt.'];
                
            end
            
        end
        distMean = 240;
        outcome = 240;
        tickInstruction.savedTickmark = nan;
        tickInstruction.previousOutcome = nan;
        [taskParam, fw, Data] = instrLoopTxt(taskParam,...
            txt, cannon, 'space', distMean, tickInstruction);
        
        if fw == 1
            
            outcome = distMean;
            background = true;
            cannonball(taskParam, distMean, outcome, background, 1, 0)
            screenIndex = screenIndex + 1;
            
            return
        end
        WaitSecs(0.1);
        
    end

    function [screenIndex, Data] = MoveSpotToLastOutcome...
            (screenIndex, Data, txt)
        t = GetSecs;
        lineAndBack(taskParam)
        drawCross(taskParam)
        drawCircle(taskParam)
        Screen('DrawingFinished', taskParam.gParam.window.onScreen, 1);
        Screen('Flip', taskParam.gParam.window.onScreen, t + 0.1, 1);
        WaitSecs(0.5);
        Data.tickMark = true;
        [taskParam, fw, Data] = instrLoopTxt(taskParam,...
            txt, cannon, 'space', Data.distMean, Data);
        
        if fw == 1
            screenIndex = screenIndex + 1;
        end
    end

    function [screenIndex] = YouDidNotCollectTheCannonBall_TryAgain...
            (screenIndex, Data, distMean, txt)
        
        background = true;
        cannonball(taskParam, Data.distMean, Data.outcome, background)
        if Data.memErr >=9
            
            lineAndBack(taskParam)
            drawCross(taskParam)
            drawCircle(taskParam)
            Screen('DrawingFinished', taskParam.gParam.window.onScreen, 1);
            t = GetSecs;
            Screen('Flip', taskParam.gParam.window.onScreen, t + 0.5, 1);
            
            while 1
                if isequal(subject.group, '1')
                    txt=['Du hast die Kanonenkugel leider nicht '...
                        'aufgesammelt. Versuche es nochmal!'];
                else
                    txt=['Sie haben die Kanonenkugel leider nicht '...
                        'aufgesammelt. Versuchen Sie es bitte nochmal!'];
                end
                
                lineAndBack(taskParam)
                drawCircle(taskParam);
                drawCross(taskParam);
                predictionSpot(taskParam);
                drawOutcome(taskParam, Data.outcome);
                drawCannon(taskParam, Data.distMean)
                TickMark(taskParam, Data.outcome, 'outc')
                TickMark(taskParam, Data.pred, 'pred')
                DrawFormattedText(taskParam.gParam.window.onScreen,...
                    taskParam.strings.txtPressEnter,'center',...
                    taskParam.gParam.screensize(4)*0.9, [255 255 255]);
                DrawFormattedText(taskParam.gParam.window.onScreen,txt,...
                    taskParam.gParam.screensize(3)*0.1,...
                    taskParam.gParam.screensize(4)*0.05,...
                    [255 255 255], sentenceLength);
                Screen('DrawingFinished',taskParam.gParam.window.onScreen);
                Screen('Flip', taskParam.gParam.window.onScreen, t + 1.5);
                [ keyIsDown, ~, keyCode ] = KbCheck;
                if keyIsDown
                    if keyCode(taskParam.keys.enter)
                        screenIndex = screenIndex - 1 ;
                        break
                    elseif keyCode(taskParam.keys.delete)
                        screenIndex = screenIndex - 5;
                        break
                    end
                end
            end
        else
            lineAndBack(taskParam)
            drawCircle(taskParam);
            drawCross(taskParam);
            predictionSpot(taskParam);
            drawOutcome(taskParam, Data.outcome);
            drawCannon(taskParam, Data.distMean)
            Screen('DrawingFinished', taskParam.gParam.window.onScreen);
            t = GetSecs;
            Screen('Flip', taskParam.gParam.window.onScreen, t + 0.1);
            lineAndBack(taskParam)
            drawCross(taskParam)
            drawCircle(taskParam)
            Screen('DrawingFinished', taskParam.gParam.window.onScreen, 1);
            Screen('Flip', taskParam.gParam.window.onScreen, t + 0.6, 1);
            while 1
                
                lineAndBack(taskParam)
                drawCannon(taskParam, Data.distMean)
                drawCircle(taskParam)
                
                if subject.rew == 1
                    shield(taskParam, 20, Data.pred, 1)
                elseif subject.rew == 2
                    shield(taskParam, 20, Data.pred, 0)
                    
                end
                drawOutcome(taskParam, Data.outcome)
                DrawFormattedText(taskParam.gParam.window.onScreen,txt,...
                    taskParam.gParam.screensize(3)*0.1,...
                    taskParam.gParam.screensize(4)*0.05,...
                    [255 255 255], sentenceLength);
                DrawFormattedText(taskParam.gParam.window.onScreen,...
                    taskParam.strings.txtPressEnter,'center',...
                    taskParam.gParam.screensize(4)*0.9, [255 255 255]);
                Screen('DrawingFinished',...
                    taskParam.gParam.window.onScreen, 1);
                Screen('Flip', taskParam.gParam.window.onScreen, t + 1.6);
                [ keyIsDown, ~, keyCode ] = KbCheck;
                if keyIsDown
                    if keyCode(taskParam.keys.enter)
                        screenIndex = screenIndex + 1;
                        break
                    elseif keyCode(taskParam.keys.delete)
                        screenIndex = screenIndex - 3;
                        break
                    end
                end
            end
        end
        WaitSecs(0.1);
    end

    function [screenIndex, Data] =...
            YouCollectedTheCannonball_TryToMissIt(screenIndex, Data, win)
        
        background = true;
        cannonball(taskParam, Data.distMean, Data.outcome, background)
        
        if Data.memErr <= 9
            
            while 1
                if isequal(subject.group, '1')
                    
                    txt=['Du hast die Kanonenkugel aufgesammelt. '...
                        'Versuche die Kanonenkugel diesmal extra nicht '...
                        'aufzusammeln!'];
                else
                    txt=['Sie haben die Kanonenkugel aufgesammelt. '...
                        'Versuchen Sie sie bitte extra nicht '...
                        'aufzusammeln!'];
                end
                
                lineAndBack(taskParam)
                drawCircle(taskParam);
                drawCross(taskParam);
                predictionSpot(taskParam);
                drawOutcome(taskParam, Data.outcome);
                drawCannon(taskParam, Data.distMean)
                DrawFormattedText(taskParam.gParam.window.onScreen,...
                    taskParam.strings.txtPressEnter,'center',...
                    taskParam.gParam.screensize(4)*0.9, [255 255 255]);
                DrawFormattedText(taskParam.gParam.window.onScreen,txt,...
                    taskParam.gParam.screensize(3)*0.1,...
                    taskParam.gParam.screensize(4)*0.05,...
                    [255 255 255], sentenceLength);
                Screen('DrawingFinished',...
                    taskParam.gParam.window.onScreen);
                t = GetSecs;
                Screen('Flip', taskParam.gParam.window.onScreen, t + 0.1);
                [ keyIsDown, ~, keyCode ] = KbCheck;
                if keyIsDown
                    if keyCode(taskParam.keys.enter)
                        screenIndex = screenIndex - 1;
                        break
                    elseif keyCode(taskParam.keys.delete)
                        screenIndex = screenIndex - 5;
                        break
                    end
                end
            end
            WaitSecs(0.1);
            
        else
            
            lineAndBack(taskParam)
            drawCircle(taskParam);
            drawCross(taskParam);
            predictionSpot(taskParam);
            drawOutcome(taskParam, Data.outcome);
            drawCannon(taskParam, Data.distMean)
            Screen('DrawingFinished', taskParam.gParam.window.onScreen);
            t = GetSecs;
            Screen('Flip', taskParam.gParam.window.onScreen, t + 0.1);
            lineAndBack(taskParam)
            drawCross(taskParam)
            drawCircle(taskParam)
            Screen('DrawingFinished', taskParam.gParam.window.onScreen, 1);
            Screen('Flip', taskParam.gParam.window.onScreen, t + 0.6, 1);
            while 1
                
                if isequal(subject.group, '1')
                    
                    txt=['Weil du die Kanonenkugel nicht aufgesammelt '...
                        'hast, hättest du nichts verdient.'];
                else
                    txt=['Weil Sie die Kanonenkugel nicht aufgesammelt '...
                        'haben, hätten Sie nichts verdient.'];
                    
                end
                
                lineAndBack(taskParam)
                drawCannon(taskParam, Data.distMean)
                drawCircle(taskParam)
                if (subject.rew == 1 && win)...
                        || (subject.rew == 2 && ~win)
                    shield(taskParam, 20, Data.pred, 1)
                elseif (subject.rew == 2 && win)...
                        || (subject.rew == 1 && ~win)
                    shield(taskParam, 20, Data.pred, 0)
                end
                drawOutcome(taskParam, Data.outcome)
                DrawFormattedText(taskParam.gParam.window.onScreen,txt,...
                    taskParam.gParam.screensize(3)*0.1,...
                    taskParam.gParam.screensize(4)*0.05,...
                    [255 255 255], sentenceLength);
                DrawFormattedText(taskParam.gParam.window.onScreen,...
                    taskParam.strings.txtPressEnter,'center',...
                    taskParam.gParam.screensize(4)*0.9, [255 255 255]);
                Screen('DrawingFinished',...
                    taskParam.gParam.window.onScreen, 1);
                Screen('Flip', taskParam.gParam.window.onScreen, t + 1.6);
                [ keyIsDown, ~, keyCode ] = KbCheck;
                if keyIsDown
                    if keyCode(taskParam.keys.enter)
                        screenIndex = screenIndex + 1;
                        break
                    elseif keyCode(taskParam.keys.delete)
                        screenIndex = screenIndex - 6;
                        break
                    end
                end
            end
            WaitSecs(0.1);
            
            
        end
        WaitSecs(0.1);
    end

    function [screenIndex, Data] =...
            YouMissedTheCannonball_TryToCollectIt(screenIndex, Data)
        
        background = true;
        Data.distMean = 160;
        Data.outcome = 160;
        cannonball(taskParam, Data.distMean, Data.outcome, background)
        if Data.memErr <= 9
            
            lineAndBack(taskParam)
            drawCircle(taskParam);
            drawCross(taskParam);
            predictionSpot(taskParam);
            drawOutcome(taskParam, Data.outcome);
            drawCannon(taskParam, Data.distMean)
            Screen('DrawingFinished', taskParam.gParam.window.onScreen);
            t = GetSecs;
            Screen('Flip', taskParam.gParam.window.onScreen, t + 0.1);
            lineAndBack(taskParam)
            drawCross(taskParam)
            drawCircle(taskParam)
            Screen('DrawingFinished', taskParam.gParam.window.onScreen, 1);
            Screen('Flip', taskParam.gParam.window.onScreen, t + 0.6, 1);
            while 1
                
                if isequal(subject.group, '1')
                    if isequal(whichPractice, 'followOutcomePractice')
                        txt=sprintf(['Du hast die Kanonenkugel '...
                            'aufgesammelt, aber der Korb war %s. '...
                            'Daher hättest du nichts verdient.'],colNoRew);
                    else
                        txt=sprintf(['Du hast die Kanonenkugel '...
                            'aufgesammelt, aber das Schild war %s. '...
                            'Daher hättest du nichts verdient.'],colNoRew);
                    end
                else
                    if isequal(whichPractice, 'followOutcomePractice')
                        txt=sprintf(['Sie haben die Kanonenkugel '...
                            'aufgesammelt, aber der Korb war %s. '...
                            'Daher hätten Sie nichts verdient.'],colNoRew);
                    else
                        txt=sprintf(['Du hast die Kanonenkugel '...
                            'aufgesammelt, aber das Schild war %s. '...
                            'Daher hätten Sie nichts verdient.'],colNoRew); 
                    end
                end
                lineAndBack(taskParam)
                drawCannon(taskParam, Data.distMean)
                drawCircle(taskParam)
                if subject.rew == 1
                    shield(taskParam, 20, Data.pred, 0)
                elseif subject.rew == 2
                    shield(taskParam, 20, Data.pred, 1)
                end
                drawOutcome(taskParam, Data.outcome)
                DrawFormattedText(taskParam.gParam.window.onScreen,txt,...
                    taskParam.gParam.screensize(3)*0.1,...
                    taskParam.gParam.screensize(4)*0.05,...
                    [255 255 255], sentenceLength);
                DrawFormattedText(taskParam.gParam.window.onScreen,...
                    taskParam.strings.txtPressEnter,'center',...
                    taskParam.gParam.screensize(4)*0.9, [255 255 255]);
                Screen('DrawingFinished',...
                    taskParam.gParam.window.onScreen, 1);
                Screen('Flip', taskParam.gParam.window.onScreen, t + 1.6);
                [ keyIsDown, ~, keyCode ] = KbCheck;
                if keyIsDown
                    if keyCode(taskParam.keys.enter)
                        screenIndex = screenIndex + 1;
                        break
                    elseif keyCode(taskParam.keys.delete)
                        screenIndex = screenIndex - 10;
                        break
                    end
                end
            end
            WaitSecs(0.1);
            
        else
            
            while 1
                
                if isequal(subject.group, '1')
                    
                    txt=['Leider hast du die Kanonenkugel nicht '...
                        'aufgesammelt. Versuche es noch einmal!'];
                else
                    txt=['Leider haben Sie die Kanonenkugel nicht '...
                        'aufgesammelt. Versuchen Sie es bitte '...
                        'noch einmal!'];
                end
                
                lineAndBack(taskParam)
                drawCircle(taskParam);
                drawCross(taskParam);
                predictionSpot(taskParam);
                drawOutcome(taskParam, Data.outcome);
                drawCannon(taskParam, Data.distMean)
                DrawFormattedText(taskParam.gParam.window.onScreen,...
                    taskParam.strings.txtPressEnter,'center',...
                    taskParam.gParam.screensize(4)*0.9, [255 255 255]);
                DrawFormattedText(taskParam.gParam.window.onScreen,txt,...
                    taskParam.gParam.screensize(3)*0.1,...
                    taskParam.gParam.screensize(4)*0.05,...
                    [255 255 255], sentenceLength);
                Screen('DrawingFinished',taskParam.gParam.window.onScreen);
                t = GetSecs;
                Screen('Flip', taskParam.gParam.window.onScreen, t + 0.1);
                [ keyIsDown, ~, keyCode ] = KbCheck;
                if keyIsDown
                    if keyCode(taskParam.keys.enter)
                        screenIndex = screenIndex - 2;
                        break
                    elseif keyCode(taskParam.keys.delete)
                        screenIndex = screenIndex - 9;
                        break
                    end
                end
            end
            WaitSecs(0.1);
            
            screenIndex = screenIndex + 1;
        end
        WaitSecs(0.1);
    end

    function [screenIndex] = performanceCriterion(screenIndex, taskData)
        
        if isequal(whichPractice, 'mainPractice')...
                || isequal(whichPractice, 'followCannonPractice')...
                || isequal(whichPractice, 'chinese')
            sumCannonDev = sum(taskData.memErr...
                >= taskParam.gParam.practiceTrialCriterion);
        elseif isequal(whichPractice, 'followOutcomePractice')
            sumCannonDev = sum(practData.controlDev...
                >= taskParam.gParam.practiceTrialCriterion);
        end
        
        if sumCannonDev >= 4
            if isequal(taskParam.gParam.taskType, 'dresden')
                
                if isequal(whichPractice, 'mainPractice')...
                        || isequal(whichPractice, 'followCannonPractice')
                    header = 'Wiederholung der Übung';
                    if isequal(subject.group, '1')
                        txt = ['In der letzten Übung hast du dich zu '...
                            'häufig vom Ziel der Kanone wegbewegt. '...
                            'Du kannst mehr Kugeln abwehren, wenn du '...
                            'immer auf dem Ziel der Kanone bleibst!'...
                            '\n\nIn der nächsten Runde kannst nochmal '...
                            'üben. Wenn du noch Fragen hast, kannst du '...
                            'dich auch an den Versuchsleiter wenden.'];
                    else
                        txt = ['In der letzten Übung haben Sie sich zu '...
                            'häufig vom Ziel der Kanone wegbewegt. '...
                            'Sie können mehr Kugeln abwehren, wenn Sie '...
                            'immer auf dem Ziel der Kanone bleiben!'...
                            '\n\nIn der nächsten Runde können Sie '...
                            'nochmal üben. Wenn Sie noch Fragen haben, '...
                            'können Sie sich auch an den '...
                            'Versuchsleiter wenden.'];
                    end
                elseif isequal(whichPractice, 'followOutcomePractice')
                    header = 'Wiederholung der Übung';
                    if isequal(subject.group, '1')
                        txt = ['In der letzten Übung hast du die '...
                            'jeweils letzte Kugel zu selten '...
                            'aufgesammelt.\n\nIn der nächsten Runde '...
                            'kannst nochmal üben. Wenn du noch Fragen '...
                            'hast, kannst du dich auch an den '...
                            'Versuchsleiter wenden.'];
                    else
                        txt = ['In der letzten Übung haben Sie die '...
                            'jeweils letzte Kugel zu selten '...
                            'aufgesammelt.\n\nIn der nächsten Runde '...
                            'können Sie nochmal üben. Wenn Sie noch '...
                            'Fragen haben, können Sie sich auch an '...
                            'den Versuchsleiter wenden.'];
                    end
                end
                
            elseif isequal(taskParam.gParam.taskType, 'oddball')
                header = 'Try it again!';
                txt = ['In that block your shield was not always '...
                    'placed where the cannon was aiming. Remember: '...
                    'Placing your shield where the cannon is aimed '...
                    'will be the best way to earn money. Now try again.'];
            elseif isequal(taskParam.gParam.taskType, 'chinese')
                header = 'Wiederholung der Übung!';
                txt = ['In der letzten Übung hast du dich zu '...
                    'häufig vom Ziel des Gegners wegbewegt. '...
                    'Du kannst mehr Kanonenkugeln abwehren, wenn du '...
                    'immer auf dem Ziel des Gegners bleibst!'...
                    '\n\nIn der nächsten Runde kannst nochmal '...
                    'üben. Wenn du noch Fragen hast, kannst du '...
                    'dich auch an den Versuchsleiter wenden.'];
            end
            feedback = false;
            fw = bigScreen(taskParam,...
                taskParam.strings.txtPressEnter, header, txt,...
                feedback);
            if fw == 1
                screenIndex = screenIndex - 1;
            elseif bw == 1
                screenIndex = screenIndex - 2;
            end
        else
            screenIndex = screenIndex + 1;
        end
        
        WaitSecs(0.1);
    end
end
